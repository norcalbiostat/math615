<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robin Donatello">
<meta name="dcterms.date" content="2024-10-07">
<meta name="description" content="lec06b">

<title>Statistical Inference using Models – Data Analysis for Graduate Research</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Data Analysis for Graduate Research</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../modules.html"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-all-materials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">All Materials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-all-materials">    
        <li>
    <a class="dropdown-item" href="../topics.html">
 <span class="dropdown-text">Topics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides.html">
 <span class="dropdown-text">Slides</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hw.html">
 <span class="dropdown-text">Assignments</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-research-project" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Research Project</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-research-project">    
        <li>
    <a class="dropdown-item" href="../project.html">
 <span class="dropdown-text">Overview and Information</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../author_guide.html">
 <span class="dropdown-text">Guide for Authors</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://drive.google.com/drive/folders/1f9oKqswqB0wo1I957xFW6yjhIt2FRhwr"> <i class="bi bi-google" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-reference-texts" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Reference Texts</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-reference-texts">    
        <li>
    <a class="dropdown-item" href="https://norcalbiostat.github.io/AppliedStatistics_notes/">
 <span class="dropdown-text">Applied Stats Notebook</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://openintro-ims.netlify.app/">
 <span class="dropdown-text">Intro to Modern Stats</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../help.html"> 
<span class="menu-text">Help</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#warm-up-exercise" id="toc-warm-up-exercise" class="nav-link active" data-scroll-target="#warm-up-exercise">Warm up exercise</a></li>
  <li><a href="#sampling-distributions" id="toc-sampling-distributions" class="nav-link" data-scroll-target="#sampling-distributions">Sampling Distributions</a></li>
  <li><a href="#mathematical-theory-guarantees" id="toc-mathematical-theory-guarantees" class="nav-link" data-scroll-target="#mathematical-theory-guarantees">Mathematical theory guarantees</a></li>
  <li><a href="#the-normal-distribution" id="toc-the-normal-distribution" class="nav-link" data-scroll-target="#the-normal-distribution">The Normal Distribution</a></li>
  <li><a href="#the-normal-distribution-1" id="toc-the-normal-distribution-1" class="nav-link" data-scroll-target="#the-normal-distribution-1">The Normal Distribution</a>
  <ul class="collapse">
  <li><a href="#distributional-notation" id="toc-distributional-notation" class="nav-link" data-scroll-target="#distributional-notation">Distributional Notation</a></li>
  <li><a href="#the-normal-distribution-2" id="toc-the-normal-distribution-2" class="nav-link" data-scroll-target="#the-normal-distribution-2">The Normal Distribution</a></li>
  <li><a href="#comparing-values-under-two-different-distributions" id="toc-comparing-values-under-two-different-distributions" class="nav-link" data-scroll-target="#comparing-values-under-two-different-distributions">Comparing values under two different distributions</a></li>
  <li><a href="#standardizing-distributions" id="toc-standardizing-distributions" class="nav-link" data-scroll-target="#standardizing-distributions">Standardizing Distributions</a></li>
  <li><a href="#z-score" id="toc-z-score" class="nav-link" data-scroll-target="#z-score">Z-score</a></li>
  <li><a href="#comparing-scores" id="toc-comparing-scores" class="nav-link" data-scroll-target="#comparing-scores">Comparing Scores</a></li>
  <li><a href="#comparing-scores-1" id="toc-comparing-scores-1" class="nav-link" data-scroll-target="#comparing-scores-1">Comparing Scores</a></li>
  <li><a href="#finding-percentiles" id="toc-finding-percentiles" class="nav-link" data-scroll-target="#finding-percentiles">Finding percentiles</a></li>
  </ul></li>
  <li><a href="#quantifying-variability-of-a-statistic" id="toc-quantifying-variability-of-a-statistic" class="nav-link" data-scroll-target="#quantifying-variability-of-a-statistic">Quantifying variability of a statistic</a>
  <ul class="collapse">
  <li><a href="#many-estimates-are-normally-distributed" id="toc-many-estimates-are-normally-distributed" class="nav-link" data-scroll-target="#many-estimates-are-normally-distributed">Many estimates are normally distributed</a></li>
  <li><a href="#rule-of-thumb" id="toc-rule-of-thumb" class="nav-link" data-scroll-target="#rule-of-thumb">68-95-99.7 rule of thumb</a></li>
  <li><a href="#sd-vs-se" id="toc-sd-vs-se" class="nav-link" data-scroll-target="#sd-vs-se">SD vs SE</a></li>
  <li><a href="#margin-of-error" id="toc-margin-of-error" class="nav-link" data-scroll-target="#margin-of-error">Margin of Error</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  <li><a href="#case-study-stents" id="toc-case-study-stents" class="nav-link" data-scroll-target="#case-study-stents">Case study: Stents</a>
  <ul class="collapse">
  <li><a href="#observed-data" id="toc-observed-data" class="nav-link" data-scroll-target="#observed-data">Observed data</a></li>
  <li><a href="#point-estimate-vs-interval-estimate" id="toc-point-estimate-vs-interval-estimate" class="nav-link" data-scroll-target="#point-estimate-vs-interval-estimate">Point estimate vs Interval estimate</a></li>
  <li><a href="#constructing-a-95-confidence-interval-ci" id="toc-constructing-a-95-confidence-interval-ci" class="nav-link" data-scroll-target="#constructing-a-95-confidence-interval-ci">Constructing a 95% confidence interval (CI)</a></li>
  <li><a href="#construct-a-95-ci-for-the-stent-example" id="toc-construct-a-95-ci-for-the-stent-example" class="nav-link" data-scroll-target="#construct-a-95-ci-for-the-stent-example">Construct a 95% CI for the stent example</a></li>
  <li><a href="#important-note" id="toc-important-note" class="nav-link" data-scroll-target="#important-note">Important note</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#hypothesis-test" id="toc-hypothesis-test" class="nav-link" data-scroll-target="#hypothesis-test">Hypothesis test</a></li>
  <li><a href="#hypothesis-test-1" id="toc-hypothesis-test-1" class="nav-link" data-scroll-target="#hypothesis-test-1">Hypothesis test</a></li>
  <li><a href="#hypothesis-test-2" id="toc-hypothesis-test-2" class="nav-link" data-scroll-target="#hypothesis-test-2">Hypothesis test</a></li>
  <li><a href="#hypothesis-test-3" id="toc-hypothesis-test-3" class="nav-link" data-scroll-target="#hypothesis-test-3">Hypothesis test</a></li>
  <li><a href="#hypothesis-test-4" id="toc-hypothesis-test-4" class="nav-link" data-scroll-target="#hypothesis-test-4">Hypothesis test</a></li>
  <li><a href="#using-the-normal-model" id="toc-using-the-normal-model" class="nav-link" data-scroll-target="#using-the-normal-model">Using the Normal model</a></li>
  <li><a href="#calculating-a-test-statistic-p-value" id="toc-calculating-a-test-statistic-p-value" class="nav-link" data-scroll-target="#calculating-a-test-statistic-p-value">Calculating a test statistic &amp; p-value</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#using-confidence-intervals-to-test-a-hypothesis" id="toc-using-confidence-intervals-to-test-a-hypothesis" class="nav-link" data-scroll-target="#using-confidence-intervals-to-test-a-hypothesis">Using Confidence Intervals to test a hypothesis</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/norcalbiostat/MATH615/edit/main/slides/lec06b-statistical_inference_with_models.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/norcalbiostat/MATH615/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="lec06b-statistical_inference_with_models.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistical Inference using Models</h1>
</div>

<div>
  <div class="description">
    lec06b
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Robin Donatello </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 7, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="warm-up-exercise" class="level2">
<h2 class="anchored" data-anchor-id="warm-up-exercise">Warm up exercise</h2>
<p>With a partner, go work through the Central Limit Theorem interactive explorer for about 15 minutes. Follow the instructions on the app and take notes and be prepared to share out what you learned/your take away message.</p>
<p><a href="https://mathisawesome.shinyapps.io/central-limit-theorem/" class="uri">https://mathisawesome.shinyapps.io/central-limit-theorem/</a></p>
</section>
<section id="sampling-distributions" class="level2">
<h2 class="anchored" data-anchor-id="sampling-distributions">Sampling Distributions</h2>
<p>Since <em>point estimates</em> are numbers calculated on a sample, they are also <em>sample statistics</em>. Recall that sample statistics are used to estimate parameters, the true value of the quantity of interest from the population.</p>
<p>As we just saw through simulation, point estimates are subject to <em>random variation</em> because they are calculated on different random samples from the population. The distribution of repeatedly calculated point estimates based on the same fixed size <span class="math inline">\(n\)</span> from a population is called a <em>sampling distribution</em>.</p>
</section>
<section id="mathematical-theory-guarantees" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="mathematical-theory-guarantees">Mathematical theory guarantees</h2>
<ul>
<li>If repeated samples are taken, a point estimate will follow something that <strong>resembles a normal distribution</strong> when certain conditions are met.
<ul>
<li><em>Note: we typically only take one sample, but the mathematical model lets us know what to expect if we had taken repeated samples</em></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations in the sample are independent.
</div>
</div>
<div class="callout-body-container callout-body">
<p>Guaranteed when we take a random sample from a population, or randomly divide individuals into treatment and control groups.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The sample is large enough.
</div>
</div>
<div class="callout-body-container callout-body">
<p>What qualifies as “large enough” differs from one context to the next. If the population is already normally distributed and the formula to calculate the sample statistic simple, then fewer samples are needed. The “magic” number 30 gets thrown around a lot.</p>
</div>
</div>
</section>
<section id="the-normal-distribution" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="the-normal-distribution">The Normal Distribution</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>The normal distribution is used to describe the variability associated with sample statistics which are taken from either repeated samples or repeated experiments. The normal distribution is quite powerful in that it describes the variability of many different statistics such as the sample mean and sample proportions.</p>
<p>Distributions of many variables are nearly normal, but none are exactly normal. While not perfect for any single problem, the Normal Distribution is very useful for a variety of problems.</p>
</div><div class="column" style="width:50%;">
<p><a href="https://twitter.com/RiddleMeCam/status/1557402268395139077?ref_src=twsrc%5Etfw"><img src="images/clt_twitter.png" class="img-fluid"></a></p>
</div>
</div>
</section>
<section id="the-normal-distribution-1" class="level1">
<h1>The Normal Distribution</h1>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pre-requisite knowledge
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is expected that you have a basic understanding of the Normal distribution. If you need a detailed refresher, refer to <a href="https://openintro-ims.netlify.app/foundations-mathematical.html#normalDist">IMS 13.2</a>.</p>
<p>What follows is a quick recap of critical details.</p>
</div>
</div>
<section id="distributional-notation" class="level2">
<h2 class="anchored" data-anchor-id="distributional-notation">Distributional Notation</h2>
<p><span class="math display">\[ X \sim \mathcal{N}(\mu, \sigma^2)\]</span> This means some random variable <span class="math inline">\(X\)</span> is distributed(<span class="math inline">\(\sim\)</span>), as a Normal (<span class="math inline">\(\mathcal{N}\)</span>) distribution centered on mean <span class="math inline">\(\mu\)</span> with variance <span class="math inline">\(\sigma^{2}\)</span>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Notational differences
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the IMS textbook uses the uncommon notation <span class="math inline">\(\mathcal{N}(\mu, \sigma)\)</span>, where the second parameter is <span class="math inline">\(\sigma\)</span>, the standard deviation.</p>
</div>
</div>
</section>
<section id="the-normal-distribution-2" class="level2">
<h2 class="anchored" data-anchor-id="the-normal-distribution-2">The Normal Distribution</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Symmetric, “bell shaped”</li>
<li>Centered on <span class="math inline">\(\mu\)</span> and spread controlled by <span class="math inline">\(\sigma^2\)</span></li>
<li>Tails extend to <span class="math inline">\(\infty\)</span></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lec06b-statistical_inference_with_models_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div><ul>
<li>Area under the curve will always add to 1.</li>
<li>Used to calculate the probability of an event occurring</li>
</ul>
</div>
</section>
<section id="comparing-values-under-two-different-distributions" class="level2">
<h2 class="anchored" data-anchor-id="comparing-values-under-two-different-distributions">Comparing values under two different distributions</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Two different college-ready exams
</div>
</div>
<div class="callout-body-container callout-body">
<p>SAT scores follow a nearly normal distribution with a mean of 1500 points and a standard deviation of 300 points.</p>
<p>ACT scores also follow a nearly normal distribution with mean of 21 points and a standard deviation of 5 points.</p>
<p>Suppose Nel scored 1800 points on their SAT and Sian scored 24 points on their ACT.</p>
</div>
</div>
<p>Who performed better?</p>
</section>
<section id="standardizing-distributions" class="level2">
<h2 class="anchored" data-anchor-id="standardizing-distributions">Standardizing Distributions</h2>
<p>If you overlay the two distributions, where the means line up and where each tick mark represents one standard deviation away from the mean, we can see who did better <em>relative to the exam average</em>.</p>
<div class="columns">
<div class="column" style="width:70%;">
<p><img src="https://openintro-ims.netlify.app/foundations-mathematical_files/figure-html/fig-satActNormals-1.png" class="img-fluid"></p>
</div><div class="column" style="width:30%;">
<p><span class="math display">\[X_{SAT} \sim \mathcal{N}(1500, 300^{2})\]</span><br>
</p>
<p><span class="math display">\[X_{ACT} \sim \mathcal{N}(21, 25)\]</span></p>
</div>
</div>
</section>
<section id="z-score" class="level2">
<h2 class="anchored" data-anchor-id="z-score">Z-score</h2>
<p>The Z score of an observation is the number of standard deviations it falls above or below the mean. We compute the Z score for an observation that follows a distribution with mean and standard deviation using</p>
<p><span class="math display">\[ Z = \frac{x- \mu}{\sigma} \]</span> If an observation <span class="math inline">\(x\)</span> comes from a <span class="math inline">\(\mathcal{N}(\mu, \sigma)\)</span> distribution, then <span class="math inline">\(Z \sim \mathcal{N}(0, 1)\)</span>. We <em>center</em> the distribution by subtracting the mean, and <em>scale</em> by dividing by the sd.</p>
</section>
<section id="comparing-scores" class="level2">
<h2 class="anchored" data-anchor-id="comparing-scores">Comparing Scores</h2>
<p>Calculate the Z-score for both Nel and Sian. Who did better?</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="incremental">
<ul class="incremental">
<li><span class="math inline">\(X_{SAT} \sim \mathcal{N}(1500, 300^{2})\)</span></li>
<li><span class="math inline">\(x_{Nel} = 1800\)</span></li>
<li><span class="math inline">\(Z_{Nel} = \frac{1800- 1500}{300} = 1\)</span></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="incremental">
<ul class="incremental">
<li><span class="math inline">\(X_{ACT} \sim \mathcal{N}(21, 25)\)</span></li>
<li><span class="math inline">\(x_{Sian} = 24\)</span></li>
<li><span class="math inline">\(Z_{Sian} = \frac{24- 21}{5} = 0.6\)</span></li>
</ul>
</div>
</div>
</div>
</section>
<section id="comparing-scores-1" class="level2">
<h2 class="anchored" data-anchor-id="comparing-scores-1">Comparing Scores</h2>
<p>While we know Nel did better, Sian didn’t do too bad! What was their <em><em>percentile</em></em> (The percent of observations below a specified value)?</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>openintro<span class="sc">::</span><span class="fu">normTail</span>(<span class="at">m =</span> <span class="dv">21</span>, <span class="at">s =</span> <span class="dv">5</span>, <span class="at">L =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lec06b-statistical_inference_with_models_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>We can find this value using <code>pnorm(z, mean, sd)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(.<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7257469</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="finding-percentiles" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="finding-percentiles">Finding percentiles</h2>
<p>If <span class="math inline">\(X \sim \mathcal{N}(\mu, \sigma^{2})\)</span>, then <code>pnorm</code> calculates the probability that a value is below a certain number <code>a</code>.</p>
<ul>
<li><span class="math inline">\(P(X &lt; a)\)</span> is found using <code>pnorm(a, mean, sd)</code></li>
</ul>
<p>A complementary function, <code>qnorm</code> calculates the <em>cutoff</em> value <code>a</code> that is needed such that a certain percent of observations (<code>q</code>) are below that value.</p>
<ul>
<li><span class="math inline">\(P(X &lt; a) = q\)</span> is found using <code>qnorm(q, mean, sd)</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(.<span class="dv">90</span>, <span class="dv">21</span>, <span class="dv">5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27.40776</code></pre>
</div>
</div>
<p>You would need to score a 27.5 to be in the top 10th percentile of ACT test takers.</p>
</section>
</section>
<section id="quantifying-variability-of-a-statistic" class="level1">
<h1>Quantifying variability of a statistic</h1>
<p>Follows <a href="https://openintro-ims.netlify.app/foundations-mathematical.html#quantifying-the-variability-of-a-statistic">IMS 13.3</a></p>
<section id="many-estimates-are-normally-distributed" class="level2">
<h2 class="anchored" data-anchor-id="many-estimates-are-normally-distributed">Many estimates are normally distributed</h2>
<ul>
<li>the sample proportion <span class="math inline">\(\hat{p}\)</span></li>
<li>the sample mean <span class="math inline">\(\bar{x}\)</span></li>
<li>differences in two sample proportions <span class="math inline">\(\hat{p}_{1} - \hat{p}_{2}\)</span></li>
<li>differences in two sample means <span class="math inline">\(\bar{x}_{1} - \bar{x}_{2}\)</span></li>
<li>the sample slope from a linear model <span class="math inline">\(\hat{\beta}\)</span></li>
</ul>
</section>
<section id="rule-of-thumb" class="level2">
<h2 class="anchored" data-anchor-id="rule-of-thumb">68-95-99.7 rule of thumb</h2>
<p>Because intuition is important.</p>
<p><img src="https://openintro-ims.netlify.app/foundations-mathematical_files/figure-html/fig-er6895997-1.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9544997</code></pre>
</div>
</div>
</section>
<section id="sd-vs-se" class="level2">
<h2 class="anchored" data-anchor-id="sd-vs-se">SD vs SE</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition: Standard Deviation (SD)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Variability of the data values (<span class="math inline">\(x\)</span>)</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition: Standard Error (SE)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Variability of the sample statistic (e.g.&nbsp;<span class="math inline">\(\bar{x}\)</span> or <span class="math inline">\(\hat{p}\)</span>)</p>
</div>
</div>
</section>
<section id="margin-of-error" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="margin-of-error">Margin of Error</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition: Margin of Error (MOE)
</div>
</div>
<div class="callout-body-container callout-body">
<p>The margin of error describes how far away observations are from their mean.</p>
<p>Often approximated as <span class="math inline">\(2 * SE\)</span></p>
</div>
</div>
<ul>
<li>95% of the observations are within one margin of error of the mean.</li>
<li>If the spread of the observations goes from some lower bound to some upper bound, a rough approximation of the <span class="math inline">\(SE\)</span> is to divide the range by 4.
<ul>
<li>If you notice the sample proportions go from 0.1 to 0.4, the SE can be approximated to be 0.075.</li>
</ul></li>
</ul>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<ul>
<li>Point estimates from a sample may be used to estimate population parameters.</li>
<li>Point estimates are not exact: they vary from one sample to another.</li>
<li>The standard error is the uncertainty of the sample statistic, and it gets smaller as you use more data to calculate the point estimate.</li>
<li>As your standard error decreases, so does your margin of error</li>
</ul>
</section>
</section>
<section id="case-study-stents" class="level1">
<h1>Case study: Stents</h1>
<p>This example and data comes from <a href="https://openintro-ims.netlify.app/foundations-mathematical.html#casestent">IMS 13.6</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>stent30 <span class="ot">&lt;-</span> openintro<span class="sc">::</span>stent30</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="observed-data" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="observed-data">Observed data</h2>
<p>Consider an experiment that examined whether implanting a stent in the brain of a patient at risk for a stroke helps reduce the risk of a stroke. The results from the first 30 days of this study are summarized in the following table.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stent30<span class="sc">$</span>group, stent30<span class="sc">$</span>outcome) <span class="sc">|&gt;</span> <span class="fu">addmargins</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           
            no event stroke Sum
  control        214     13 227
  treatment      191     33 224
  Sum            405     46 451</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stent30<span class="sc">$</span>group, stent30<span class="sc">$</span>outcome) <span class="sc">|&gt;</span>  <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">1</span>) <span class="sc">|&gt;</span><span class="fu">round</span>(<span class="at">digits=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           
            no event stroke
  control       0.94   0.06
  treatment     0.85   0.15</code></pre>
</div>
</div>
</div>
</div>
<p>These results are surprising! The point estimate suggests that patients who received stents may have a higher risk of stroke: <span class="math inline">\(p_{trmt}−p_{ctrl}=0.090\)</span>.</p>
</section>
<section id="point-estimate-vs-interval-estimate" class="level2">
<h2 class="anchored" data-anchor-id="point-estimate-vs-interval-estimate">Point estimate vs Interval estimate</h2>
<p>The point estimate for the difference in proportions <span class="math inline">\(p_{trmt}−p_{ctrl}=0.090\)</span> is a single point estimate, based on this single sample.</p>
<p><br>
</p>
<p>A <em>point estimate</em> is our best guess for the value of the parameter, so it makes sense to build the confidence interval around that value.</p>
</section>
<section id="constructing-a-95-confidence-interval-ci" class="level2">
<h2 class="anchored" data-anchor-id="constructing-a-95-confidence-interval-ci">Constructing a 95% confidence interval (CI)</h2>
<p>When the sampling distribution of a point estimate can <em>reasonably be modeled as having a normal distribution</em>, the point estimate we observe will be within 1.96 standard errors of the true value of interest about 95% of the time. Thus, a 95% confidence interval for such a point estimate can be constructed:</p>
<p><span class="math display">\[\mbox{point estimate} \pm 1.96 × SE\]</span></p>
<p>We can be 95% confident this interval captures the true value.</p>
</section>
<section id="construct-a-95-ci-for-the-stent-example" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="construct-a-95-ci-for-the-stent-example">Construct a 95% CI for the stent example</h2>
<p>The conditions necessary to ensure the point estimate <span class="math inline">\(p_{trmt}−p_{ctrl}\)</span> is nearly normal have been verified for you, and the estimate’s standard error is <span class="math inline">\(SE = 0.028\)</span>.</p>
<ul>
<li>Construct a 95% confidence interval for the change in 30-day stroke rates from usage of the stent.</li>
<li>Interpret this interval in context of the problem.</li>
</ul>
<p>. . .</p>
<p><span class="math display">\[0.090 \pm 1.96×0.028 = (0.035,0.145)\]</span></p>
<p>We are 95% confident that implanting a stent in a stroke patient’s brain increased the risk of stroke within 30 days by a rate of 0.035 to 0.145.</p>
</section>
<section id="important-note" class="level2">
<h2 class="anchored" data-anchor-id="important-note">Important note</h2>
<p><span class="emoji" data-emoji="warning">⚠️</span> it’s incorrect to say that we can be 95% confident that the true value is inside the mean.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://openintro-ims.netlify.app/foundations-mathematical_files/figure-html/fig-95PercentConfidenceInterval-1.png" class="img-fluid figure-img"></p>
<figcaption>Figure 13.11: Twenty-five samples of size n=300 were collected from a population with p=0.30. For each sample, a confidence interval was created to try to capture the true proportion p.&nbsp;However, 1 of these 25 intervals did not capture p=0.30.</figcaption>
</figure>
</div>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<ul>
<li>This is one of the most common errors: while it might be useful to think of it as a probability, the confidence level only quantifies how plausible it is that the parameter is in the interval.</li>
<li>Our intervals say nothing about the confidence of capturing individual observations, a proportion of the observations, or about capturing point estimates.</li>
<li>Confidence intervals provide an interval estimate for and attempt to capture population parameters.</li>
</ul>
</section>
<section id="hypothesis-test" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-test">Hypothesis test</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
First draft
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let’s setup a hypothesis to test if stents work to reduce the risk of a stroke.</p>
</div>
</div>
<p><br>
</p>
<p><span class="math inline">\(H_{0}\)</span>: Stents don’t work</p>
<p><span class="math inline">\(H_{A}\)</span>: Stents reduce the risk of a stroke</p>
</section>
<section id="hypothesis-test-1" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-test-1">Hypothesis test</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Revision 1:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Making it a statement about two groups</p>
</div>
</div>
<p><span class="math inline">\(H_{0}\)</span>: Patients who have a stent have the same risk of a stroke as patients who don’t have a stent</p>
<p><span class="math inline">\(H_{A}\)</span>: Patients who have a stent have lower risk of a stroke as patients who don’t have a stent</p>
</section>
<section id="hypothesis-test-2" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-test-2">Hypothesis test</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Revision 2:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Make it a statement using summary statistics and removing the directionality of the hypothesis</p>
</div>
</div>
<p><span class="math inline">\(H_{0}\)</span>: The proportion of patients with a stent who have a stroke is the same as the proportion of patients without a stent who have a stroke.</p>
<p><span class="math inline">\(H_{A}\)</span>: The proportion of patients with a stent who have a stroke is different than the proportion of patients without a stent who have a stroke.</p>
</section>
<section id="hypothesis-test-3" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-test-3">Hypothesis test</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Revision 3:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Writing it in symbols</p>
</div>
</div>
<p>Let <span class="math inline">\(p_{trmt}\)</span> be the proportion of patients with a stent who have a stroke, and <span class="math inline">\(p_{ctrl}\)</span> be the proportion of patients without a stent who have a stroke</p>
<p><br>
</p>
<p><span class="math inline">\(H_{0}: p_{trmt} = p_{ctrl}\)</span></p>
<p><span class="math inline">\(H_{A}: p_{trmt} \neq p_{ctrl}\)</span></p>
</section>
<section id="hypothesis-test-4" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-test-4">Hypothesis test</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Revision 3.5:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Rewriting as a difference in parameters</p>
</div>
</div>
<p>Let <span class="math inline">\(p_{1}\)</span> be the proportion of patients with a stent who have a stroke, and <span class="math inline">\(p_{ctrl}\)</span> be the proportion of patients without a stent who have a stroke</p>
<p><br>
</p>
<p><span class="math inline">\(H_{0}: p_{trmt} - p_{ctrl} = 0\)</span></p>
<p><span class="math inline">\(H_{A}: p_{trmt} - p_{ctrl} \neq 0\)</span></p>
</section>
<section id="using-the-normal-model" class="level2">
<h2 class="anchored" data-anchor-id="using-the-normal-model">Using the Normal model</h2>
<ul>
<li><p>Now we have a statistic (difference in proportions <span class="math inline">\(p_{trmt} - p_{ctrl}\)</span>) and a null value of 0 to compare it to.</p></li>
<li><p>The conditions necessary to ensure the point estimate is nearly normal have been verified for you.</p></li>
<li><p>The estimate’s standard error is <span class="math inline">\(SE = 0.028\)</span> has been calculated for you as well.</p></li>
</ul>
</section>
<section id="calculating-a-test-statistic-p-value" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="calculating-a-test-statistic-p-value">Calculating a test statistic &amp; p-value</h2>
<p><span class="math display">\[ Z = \frac{\mbox{point estimate - null value}}{SE}\]</span></p>
<p>. . .</p>
<p><span class="math display">\[ Z = \frac{(p_{trmt} - p_{ctrl}) - 0}{SE_{p_{trmt} - p_{ctrl}}} = \frac{.090}{.028} = 3.21 \]</span></p>
<p>. . .</p>
<p><span class="math display">\[ P(Z &gt; 3.2) = .00068 \qquad \mbox{ (the p-value)}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fl">3.2</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0006871379</code></pre>
</div>
</div>
<p>. . .</p>
<p>If the true difference in proportions was 0, then the probability of observing a difference of 0.09 due to random chance is 0.00068.</p>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://imgs.xkcd.com/comics/p_values.png" class="img-fluid figure-img"></p>
<figcaption>https://xkcd.com/1478/</figcaption>
</figure>
</div>
</section>
<section id="using-confidence-intervals-to-test-a-hypothesis" class="level2">
<h2 class="anchored" data-anchor-id="using-confidence-intervals-to-test-a-hypothesis">Using Confidence Intervals to test a hypothesis</h2>
<blockquote class="blockquote">
<p>We are 95% confident that implanting a stent in a stroke patient’s brain increased the risk of stroke within 30 days by a rate of 0.035 to 0.145.</p>
</blockquote>
<p>Since the interval does not contain the null hypothesized value of 0 (is completely above 0), it means the data provide convincing evidence that the stent used in the study changed the risk of stroke within 30 days</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/norcalbiostat\.github\.io\/MATH615");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This site is built with 💚 and <a href="https://quarto.org/">Quarto</a> by <a href="www.norcalbiostat.com">Robin Donatello</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/norcalbiostat/MATH615/edit/main/slides/lec06b-statistical_inference_with_models.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/norcalbiostat/MATH615/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>