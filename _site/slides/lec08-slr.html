<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robin Donatello">
<meta name="dcterms.date" content="2024-10-28">
<meta name="description" content="lec08">

<title>Data Analysis for Graduate Research - Simple Linear Regression Modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Data Analysis for Graduate Research</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../modules.html"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-all-materials" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">All Materials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-all-materials">    
        <li>
    <a class="dropdown-item" href="../topics.html">
 <span class="dropdown-text">Topics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides.html">
 <span class="dropdown-text">Slides</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hw.html">
 <span class="dropdown-text">Assignments</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-research-project" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Research Project</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-research-project">    
        <li>
    <a class="dropdown-item" href="../project.html">
 <span class="dropdown-text">Overview and Information</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../author_guide.html">
 <span class="dropdown-text">Guide for Authors</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://drive.google.com/drive/folders/1f9oKqswqB0wo1I957xFW6yjhIt2FRhwr"> <i class="bi bi-google" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-reference-texts" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Reference Texts</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-reference-texts">    
        <li>
    <a class="dropdown-item" href="https://norcalbiostat.github.io/AppliedStatistics_notes/">
 <span class="dropdown-text">Applied Stats Notebook</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://openintro-ims.netlify.app/">
 <span class="dropdown-text">Intro to Modern Stats</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../help.html"> 
<span class="menu-text">Help</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#purpose-estimation" id="toc-purpose-estimation" class="nav-link active" data-scroll-target="#purpose-estimation">Purpose &amp; Estimation</a>
  <ul class="collapse">
  <li><a href="#purpose-of-regression-modeling" id="toc-purpose-of-regression-modeling" class="nav-link" data-scroll-target="#purpose-of-regression-modeling">Purpose of Regression Modeling</a></li>
  <li><a href="#examples-in-practice" id="toc-examples-in-practice" class="nav-link" data-scroll-target="#examples-in-practice">Examples in practice</a></li>
  <li><a href="#example---lung-function" id="toc-example---lung-function" class="nav-link" data-scroll-target="#example---lung-function">Example - Lung function</a></li>
  <li><a href="#visualize-the-relationship" id="toc-visualize-the-relationship" class="nav-link" data-scroll-target="#visualize-the-relationship">Visualize the relationship</a></li>
  <li><a href="#unifying-model-framework" id="toc-unifying-model-framework" class="nav-link" data-scroll-target="#unifying-model-framework">Unifying model framework</a></li>
  <li><a href="#least-squares-estimation" id="toc-least-squares-estimation" class="nav-link" data-scroll-target="#least-squares-estimation">Least Squares Estimation</a></li>
  <li><a href="#least-squares-estimation-1" id="toc-least-squares-estimation-1" class="nav-link" data-scroll-target="#least-squares-estimation-1">Least Squares Estimation</a></li>
  </ul></li>
  <li><a href="#partitioning-the-variance" id="toc-partitioning-the-variance" class="nav-link" data-scroll-target="#partitioning-the-variance">Partitioning the Variance</a>
  <ul class="collapse">
  <li><a href="#revisiting-the-sum-of-squares" id="toc-revisiting-the-sum-of-squares" class="nav-link" data-scroll-target="#revisiting-the-sum-of-squares">Revisiting the Sum of Squares</a></li>
  <li><a href="#sum-of-squares---regression" id="toc-sum-of-squares---regression" class="nav-link" data-scroll-target="#sum-of-squares---regression">Sum of Squares - Regression</a></li>
  </ul></li>
  <li><a href="#fitting-the-model" id="toc-fitting-the-model" class="nav-link" data-scroll-target="#fitting-the-model">Fitting the model</a>
  <ul class="collapse">
  <li><a href="#least-squares-estimation---in-r" id="toc-least-squares-estimation---in-r" class="nav-link" data-scroll-target="#least-squares-estimation---in-r">Least Squares Estimation - in R</a></li>
  <li><a href="#using-this-model" id="toc-using-this-model" class="nav-link" data-scroll-target="#using-this-model">Using this model</a></li>
  <li><a href="#other-facts-about-ls-regression" id="toc-other-facts-about-ls-regression" class="nav-link" data-scroll-target="#other-facts-about-ls-regression">Other facts about LS regression</a></li>
  </ul></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions">Assumptions</a>
  <ul class="collapse">
  <li><a href="#mathematical-model" id="toc-mathematical-model" class="nav-link" data-scroll-target="#mathematical-model">Mathematical Model</a></li>
  <li><a href="#assumption---independence" id="toc-assumption---independence" class="nav-link" data-scroll-target="#assumption---independence">Assumption - Independence</a></li>
  <li><a href="#assumption---linearity" id="toc-assumption---linearity" class="nav-link" data-scroll-target="#assumption---linearity">Assumption - Linearity</a></li>
  <li><a href="#assumption---normality" id="toc-assumption---normality" class="nav-link" data-scroll-target="#assumption---normality">Assumption - Normality</a></li>
  <li><a href="#assumption---homoscedasticity" id="toc-assumption---homoscedasticity" class="nav-link" data-scroll-target="#assumption---homoscedasticity">Assumption - Homoscedasticity</a></li>
  <li><a href="#out-of-range-predictions" id="toc-out-of-range-predictions" class="nav-link" data-scroll-target="#out-of-range-predictions">Out of range predictions</a></li>
  <li><a href="#model-check" id="toc-model-check" class="nav-link" data-scroll-target="#model-check">Model-check</a></li>
  </ul></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference">Inference</a>
  <ul class="collapse">
  <li><a href="#distribution-of-parameter-estimates" id="toc-distribution-of-parameter-estimates" class="nav-link" data-scroll-target="#distribution-of-parameter-estimates">Distribution of parameter estimates</a></li>
  <li><a href="#calculating-confidence-intervals" id="toc-calculating-confidence-intervals" class="nav-link" data-scroll-target="#calculating-confidence-intervals">Calculating Confidence Intervals</a></li>
  <li><a href="#hypotheis-testing" id="toc-hypotheis-testing" class="nav-link" data-scroll-target="#hypotheis-testing">Hypotheis Testing</a></li>
  <li><a href="#write-a-conclusion" id="toc-write-a-conclusion" class="nav-link" data-scroll-target="#write-a-conclusion">Write a conclusion</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/norcalbiostat/MATH615/edit/main/slides/lec08-slr.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/norcalbiostat/MATH615/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="lec08-slr.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Simple Linear Regression Modeling</h1>
</div>

<div>
  <div class="description">
    lec08
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Robin Donatello </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 28, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="purpose-estimation" class="level1">
<h1>Purpose &amp; Estimation</h1>
<section id="purpose-of-regression-modeling" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="purpose-of-regression-modeling">Purpose of Regression Modeling</h2>
<ul>
<li>Learn more about the relationship between several independent or predictor variables and a <strong>quantitative</strong> dependent (response) variable.</li>
<li>Regression is widely used in research as it allows us to ask the general question “<em>what is the best predictor of</em>…”, and does “<em>additional variable A</em>” or “<em>additional variable B confound the relationship between my explanatory and response variable?</em>”</li>
</ul>
<p>Both Regression and Correlation can be used to</p>
<ul>
<li><strong>Descriptive</strong>: Draw inferences regarding the relationship</li>
<li><strong>Predictive</strong>: Predict the value of <span class="math inline">\(Y\)</span> for given values of one or more <span class="math inline">\(X\)</span>’s.</li>
</ul>
</section>
<section id="examples-in-practice" class="level2">
<h2 class="anchored" data-anchor-id="examples-in-practice">Examples in practice</h2>
<ul>
<li>Educational researchers might want to learn about the best predictors of success in high-school.</li>
<li>Sociologists may want to find out which of the multiple social indicators best predict whether or not a new immigrant group will adapt to their new country of residence.</li>
<li>Biologists may want to find out which factors (i.e.&nbsp;temperature, barometric pressure, humidity, etc.) best predict caterpillar reproduction.</li>
</ul>
</section>
<section id="example---lung-function" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="example---lung-function">Example - Lung function</h2>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Lung function data were obtained from an epidemiological study of households living in four areas with different amounts and types of air pollution. The data set used in PMA6 is a subset of the total data. In this example we use only the data taken on the fathers, all of whom are nonsmokers.</p>
</div>
</div>
</div>
<p>One of the major early indicators of reduced respiratory function is FEV1 or forced expiratory volume in the first second (amount of air exhaled in 1 second). Since it is known that taller males tend to have higher FEV1, we wish to determine the relationship between height and FEV1. We can use regression analysis for both a descriptive and predictive purpose.</p>
<ul>
<li><strong>Descriptive</strong>: Describing the relationship between FEV1 and height</li>
<li><strong>Predictive</strong>: Determine the expected or normal FEV1 for a given height</li>
</ul>
</section>
<section id="visualize-the-relationship" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="visualize-the-relationship">Visualize the relationship</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fev, <span class="fu">aes</span>(<span class="at">y=</span>FFEV1, <span class="at">x=</span>FHEIGHT)) <span class="sc">+</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(<span class="st">"Height"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(<span class="st">"Scatterplot and Regression line of FEV1 </span><span class="sc">\n</span><span class="st"> Versus Height for Males."</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lec08-slr_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:60%;">
<p><br>
There does appear to be a tendency for taller men to have higher FEV1. Since this relationship is reasonably linear (the blue loess line is similar to the red linear line) we can write the model the population average FEV <span class="math inline">\(\mu_{y}\)</span> as a linear function of height <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[
  \mu_{y} = \beta_{0} + \beta_{1}x
\]</span></p>
<p>The intercept parameter, <span class="math inline">\(\beta_{0}\)</span>, represents where the line crosses the y-axis when <span class="math inline">\(x=0\)</span>. The slope parameter, <span class="math inline">\(\beta_{1}\)</span>, represents the change in <span class="math inline">\(\mu_{y}\)</span> per 1 unit <span class="math inline">\(x\)</span>.</p>
</div>
</div>
</section>
<section id="unifying-model-framework" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="unifying-model-framework">Unifying model framework</h2>
<p>We know that there is always random noise in real data (DATA = MODEL FIT + RESIDUAL) so we introduce a random error term, <span class="math inline">\(\epsilon_{i}\)</span> and assume the model:</p>
<p><span class="math display">\[
y_{i} = \beta_{0} + \beta_{1} X + \epsilon_{i} \\
\epsilon_{i} \sim N(0, \sigma^{2})
\]</span></p>
<p>This model states that the random variable <span class="math inline">\(y\)</span> to be made up of a predictable part (a linear function of <span class="math inline">\(x\)</span>) and an unpredictable part (the random error, <span class="math inline">\(\epsilon_{i}\)</span>). The error (residual) term includes the effects of all other factors, known or unknown.</p>
</section>
<section id="least-squares-estimation" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="least-squares-estimation">Least Squares Estimation</h2>
<ul>
<li>Most common method of fitting a straight line to two variables.</li>
<li>Also known as “Ordinary Least Squares (OLS)”</li>
<li>Calculates sample statistics <span class="math inline">\(b_{0}\)</span> and <span class="math inline">\(b_{1}\)</span> to estimate the population parameter values <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span></li>
<li>The estimated mean function is <span class="math inline">\(\hat{y}_{i} = b_{0} + b_{1}x_{i}\)</span></li>
<li>The <em>fitted value</em>, <span class="math inline">\(\hat{y}_{i}\)</span>, is the estimated value for point <span class="math inline">\(i\)</span>, calculated by plugging in a value for <span class="math inline">\(x_{i}\)</span> and calculating the result.<br>
</li>
<li>The <em>residual</em> is the difference between the observed and the fitted value: <span class="math inline">\(\epsilon_{i} = y_{i}-\hat{y}_{i}\)</span></li>
</ul>
</section>
<section id="least-squares-estimation-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="least-squares-estimation-1">Least Squares Estimation</h2>
<p>The estimates <span class="math inline">\(b_{0}\)</span> and <span class="math inline">\(b_{1}\)</span> are found such that they minimize the sum of the squared residuals (the unexplained residual error)</p>
<p><span class="math display">\[ \sum_{i=1}^{n} \epsilon_{i} \]</span></p>
<p>For simple linear regression the regression coefficient estimates that minimize the sum of squared errors can be calculated as:</p>
<p><span class="math display">\[ \hat{\beta_{0}} = \bar{y} - \hat{\beta_{1}}\bar{x} \quad \mbox{  and  } \quad  \hat{\beta_{1}} = r\frac{s_{y}}{s_{x}} \]</span></p>
<p>where <span class="math inline">\(r\)</span> is the correlation coefficient between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
</section>
</section>
<section id="partitioning-the-variance" class="level1">
<h1>Partitioning the Variance</h1>
<section id="revisiting-the-sum-of-squares" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="revisiting-the-sum-of-squares">Revisiting the Sum of Squares</h2>
<p>Go to: <a href="https://paternogbc.shinyapps.io/SS_regression/">https://paternogbc.shinyapps.io/SS_regression/</a>. Then turn and talk to your group about the following features of the <strong>Sum of Squares Graphs</strong></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Total</strong></p>
<ul>
<li>What are the dots?</li>
<li>What does the horizontal line represent?</li>
<li>What do the blue lines represent?</li>
</ul>
</div><div class="column" style="width:50%;">
<p><strong>Regression</strong></p>
<ul>
<li>What does the horizontal line represent?</li>
<li>What does the sloped line represent?</li>
<li>What are the green lines?</li>
</ul>
<p><strong>Error</strong></p>
<ul>
<li>What are the dots?</li>
<li>What does the sloped line represent?</li>
<li>What do the red lines represent?</li>
</ul>
</div>
</div>
</section>
<section id="sum-of-squares---regression" class="level2">
<h2 class="anchored" data-anchor-id="sum-of-squares---regression">Sum of Squares - Regression</h2>
<ul>
<li>SS Total- how far are the points away from <span class="math inline">\(\bar{y}\)</span>?</li>
<li>SS Regression - how far away is the regression line from <span class="math inline">\(\bar{y}\)</span>?</li>
<li>SS Error - how far are the points away from the estimated regression line?</li>
</ul>
<p>Looking at it this way, we are asking “If I know the value of <span class="math inline">\(x\)</span>, how much better will I be at predicting <span class="math inline">\(y\)</span> than if I were just to use <span class="math inline">\(\bar{y}\)</span>?</p>
</section>
</section>
<section id="fitting-the-model" class="level1">
<h1>Fitting the model</h1>
<section id="least-squares-estimation---in-r" class="level2">
<h2 class="anchored" data-anchor-id="least-squares-estimation---in-r">Least Squares Estimation - in R</h2>
<p>A linear model using least squares estimation can be performed in R using the function <code>lm(y ~ x)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fev.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(FFEV1 <span class="sc">~</span> FHEIGHT, <span class="at">data =</span> fev)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>fev.model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = FFEV1 ~ FHEIGHT, data = fev)

Coefficients:
(Intercept)      FHEIGHT  
    -4.0867       0.1181  </code></pre>
</div>
</div>
<p>The regression equation for the model to explain FEV1 using height as a predictor is:<br>
<span class="math display">\[ \hat{y} = -4.087 + 0.118x \]</span></p>
</section>
<section id="using-this-model" class="level2">
<h2 class="anchored" data-anchor-id="using-this-model">Using this model</h2>
<p><span class="math display">\[ \hat{y} = -4.087 + 0.118x \]</span></p>
<ul>
<li><span class="math inline">\(b_{0}\)</span>: For a father that is 0 cm tall, the predicted FEV is -4.087 (an impossible result)</li>
<li><span class="math inline">\(b_{1}\)</span>: For every additional cm taller a father is, his predicted FEV increases by 0.118L.</li>
<li><span class="math inline">\(\hat{y}_{x=70}\)</span>: A father who is 70cm tall has a predicted FEV1 of <span class="math inline">\(-4.087 + 0.118(70) = 4.17L\)</span></li>
</ul>
</section>
<section id="other-facts-about-ls-regression" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="other-facts-about-ls-regression">Other facts about LS regression</h2>
<ul>
<li>A change of one sd in <span class="math inline">\(x\)</span> corresponds to a change of <span class="math inline">\(r\)</span> sd in <span class="math inline">\(y\)</span> since <span class="math inline">\(b_{1}=r\frac{s_{y}}{s_{x}}\)</span>.</li>
<li>If the correlation is 0, the slope of the LS line is 0. A test of <span class="math inline">\(\beta_{1}=0\)</span> is equivalent to a test of <span class="math inline">\(\rho=0\)</span>.</li>
<li>The LS line always passes through the point <span class="math inline">\((\bar{x}, \bar{y})\)</span>.</li>
<li>The distinction between explanatory and response variables is essential in regression. Reversing <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> results in a different regression line.</li>
<li>The Root Mean Squared Error (RMSE) is an estimate for <span class="math inline">\(\sigma\)</span>.</li>
</ul>
</section>
</section>
<section id="assumptions" class="level1">
<h1>Assumptions</h1>
<section id="mathematical-model" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="mathematical-model">Mathematical Model</h2>
<p>The mathematical model that we use for regression has these features that translate into assumptions.</p>
<div class="columns">
<div class="column" style="width:40%;">
<p><span class="math display">\[
\begin{align}
  Y|X &amp; \sim N(\mu_{Y|X}, \sigma^{2}) \\
  \mu_{Y|X} &amp; = \beta_{0} + \beta_{1} X \\
   \sigma^{2} &amp; = Var(Y|X)
\end{align}
\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/slr_graph.png" class="img-fluid figure-img"></p>
<figcaption>Figure 6.2</figcaption>
</figure>
</div>
</div><div class="column" style="width:60%;">
<div class="incremental">
<ul class="incremental">
<li><strong>Independence</strong> The observations are the result of a simple random sample and thus are independent from each other</li>
<li><strong>Linearity</strong>: The mean of <span class="math inline">\(Y\)</span> values at any given <span class="math inline">\(X\)</span> follows a straight line</li>
<li><strong>Normality</strong>: <span class="math inline">\(Y\)</span> values are normally distributed at any given <span class="math inline">\(X\)</span></li>
<li><strong>Homoscedasticity</strong> The variance of <span class="math inline">\(Y\)</span> values at any <span class="math inline">\(X\)</span> is <span class="math inline">\(\sigma^2\)</span> (same for all X)</li>
<li>The last two assumptions are checked by examining the <strong>residuals</strong>, and so can only be checked after the model has been fit.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="assumption---independence" class="level2">
<h2 class="anchored" data-anchor-id="assumption---independence">Assumption - Independence</h2>
<ul>
<li>Knowledge of the method of data collection here is key!</li>
<li>If the sampling method is not random, observations may not be independent.</li>
<li>No real good way to “test” for independence. Need to know how the sample was obtained.</li>
<li>Non simple random sample will not result in the same variance estimates</li>
<li>Can use hierarchical/multi-level models for clustered samples</li>
</ul>
</section>
<section id="assumption---linearity" class="level2">
<h2 class="anchored" data-anchor-id="assumption---linearity">Assumption - Linearity</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lec08-slr_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="288"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>Slight departures OK</li>
<li>Can use transformations of strongly skewed data to achieve it</li>
<li>The lowess trend line reasonably follows a linear pattern.</li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fev, <span class="fu">aes</span>(<span class="at">y=</span>FFEV1, <span class="at">x=</span>FHEIGHT)) <span class="sc">+</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">col=</span><span class="st">"blue"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">se=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="assumption---normality" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="assumption---normality">Assumption - Normality</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lec08-slr_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lec08-slr_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>Slight departures OK</li>
<li>Can use transformations to achieve it</li>
</ul>
<p>These plots are generated from the <code>performance</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">check_normality</span>(fev.model), <span class="at">type=</span><span class="st">"density"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">check_normality</span>(fev.model), <span class="at">type=</span><span class="st">"qq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>The residuals follow a normal distribution well.</li>
<li>Don’t let the pattern of the residuals on the qqplot fool you, the y-axis is very zoomed in.</li>
</ul>
</div>
</div>
</section>
<section id="assumption---homoscedasticity" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="assumption---homoscedasticity">Assumption - Homoscedasticity</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">check_heteroskedasticity</span>(fev.model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lec08-slr_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>If the variance (std. residual) changes with the value of <span class="math inline">\(\hat{y}\)</span>, that is a sign of non-constant variance.</li>
<li>Violations result in reduced validity of inference and typically larger standard errors for the coefficients.</li>
<li>Could be caused by outliers or model mis-specificiation (e.g.&nbsp;non-normal data)</li>
<li>FEV Example - even though there is a slight increase in the trend of fitted values against the residuals, this is within the tolerance range.</li>
</ul>
</div>
</div>
</section>
<section id="out-of-range-predictions" class="level2">
<h2 class="anchored" data-anchor-id="out-of-range-predictions">Out of range predictions</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><br>
</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/slr_graph.png" class="img-fluid figure-img"></p>
<figcaption>Figure 6.2</figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution!
</div>
</div>
<div class="callout-body-container callout-body">
<p>The linear model is only valid within the range of the data used to fit the model</p>
<p>To take an extreme example, suppose a father was 2 feet tall. Then the equation would predict an impossible negative value of FEV1 (<span class="math inline">\(-1.255\)</span>).</p>
<p>A safe policy is to restrict the use of the equation to the range of the <span class="math inline">\(X\)</span> observed in the sample.</p>
</div>
</div>
</div>
</div>
</section>
<section id="model-check" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="model-check">Model-check</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">check_posterior_predictions</span>(fev.model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lec08-slr_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:40%;">
<p>Another way of assessing model fit is to check the distribution of the predictions created by this model. A good fitting model should predict values that are similar to the observed data used to fit the model.</p>
</div>
</div>
</section>
</section>
<section id="inference" class="level1">
<h1>Inference</h1>
<section id="distribution-of-parameter-estimates" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="distribution-of-parameter-estimates">Distribution of parameter estimates</h2>
<ul>
<li>The estimated coefficients are functions of both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, and they are not themselves independent of each other (e.g.&nbsp;<span class="math inline">\(Cov(b_{0}, b_{1}) \neq 0)\)</span>.</li>
<li>The joint vector <span class="math inline">\(\hat{\beta}(y, x)= (b_{0}, b_{1})\)</span> has a multivariate normal distribution, with variance that depends on the predictor variables <span class="math inline">\(x\)</span> only.</li>
</ul>
<p><span class="math display">\[
\hat{\beta}(y, x) \sim \mathcal{N}(\beta, \mathbf{x^{T}x}^{-1}\sigma^{2})
\]</span></p>
<ul>
<li>The normality of the vector <span class="math inline">\(\hat{\beta}\)</span> is quite robust to the model assumptions.</li>
<li>Even if the residuals are not normally distributed, the CLT ensures that the <span class="math inline">\(\hat{\beta}\)</span> are close to normal</li>
<li>When sample sizes are low in a category, or <span class="math inline">\(Var(X)\)</span> is close to zero, <span class="math inline">\(x^{T}x\)</span> can’t be inverted - leading to errors of “non positive definite”</li>
</ul>
</section>
<section id="calculating-confidence-intervals" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="calculating-confidence-intervals">Calculating Confidence Intervals</h2>
<p><span class="math display">\[ b_{p} \pm 1.96*SE(b_{p})\]</span></p>
<blockquote class="blockquote">
<p>point estimate <span class="math inline">\(\pm\)</span> critical value * standard error of estimate</p>
</blockquote>
<p>But calculating the variance of <span class="math inline">\(b_{p}\)</span> involves <span class="math inline">\(\mathbf{x^{T}x}^{-1}\sigma^{2}\)</span>, which is outside the scope of this class. So, we use R functions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fev.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %     97.5 %
(Intercept) -6.36315502 -1.8102499
FHEIGHT      0.08526328  0.1509472</code></pre>
</div>
</div>
<p>We can be 95% confident that the true slope parameter between a fathers height and his FEV1 is contained in the interval (0.085, 0.151).</p>
</section>
<section id="hypotheis-testing" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="hypotheis-testing">Hypotheis Testing</h2>
<p>Let <span class="math inline">\(\beta_1\)</span> be the true slope parameter that describes the change in FEV1 as a function of height in cm.</p>
<ul>
<li><span class="math inline">\(H_{0}: \beta_{1}=0\)</span> There is no linear relationship between FEV1 and Height</li>
<li><span class="math inline">\(H_{A}: \beta_{1} \neq 0\)</span> Alternate Hypothesis: There is a linear relationship between FEV1 and Height</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(fev.model) <span class="sc">|&gt;</span> <span class="fu">kable</span>(<span class="at">digits=</span><span class="dv">3</span>) <span class="co">#kable is in the knitr package</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-4.087</td>
<td style="text-align: right;">1.152</td>
<td style="text-align: right;">-3.548</td>
<td style="text-align: right;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">FHEIGHT</td>
<td style="text-align: right;">0.118</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">7.106</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The p-value for <span class="math inline">\(b_{1}\)</span> is &lt;.0001, so there is sufficient evidence to believe that there is a linear relationship between FEV1 and Height of fathers.</p>
</section>
<section id="write-a-conclusion" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="write-a-conclusion">Write a conclusion</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Base R (ish)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fev.model <span class="sc">|&gt;</span> <span class="fu">coefficients</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     FHEIGHT 
 -4.0867025   0.1181052 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fev.model <span class="sc">|&gt;</span> <span class="fu">confint</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %     97.5 %
(Intercept) -6.36315502 -1.8102499
FHEIGHT      0.08526328  0.1509472</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fev.model <span class="sc">|&gt;</span> <span class="fu">r2</span>() <span class="co"># from the performance package</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Linear Regression
       R2: 0.254
  adj. R2: 0.249</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>gtsummary package</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(fev.model) <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_glance_table</span>(<span class="at">include =</span> <span class="fu">c</span>(nobs, r.squared))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="afkfmzqecc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#afkfmzqecc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#afkfmzqecc thead, #afkfmzqecc tbody, #afkfmzqecc tfoot, #afkfmzqecc tr, #afkfmzqecc td, #afkfmzqecc th {
  border-style: none;
}

#afkfmzqecc p {
  margin: 0;
  padding: 0;
}

#afkfmzqecc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#afkfmzqecc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#afkfmzqecc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#afkfmzqecc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#afkfmzqecc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#afkfmzqecc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#afkfmzqecc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#afkfmzqecc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#afkfmzqecc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#afkfmzqecc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#afkfmzqecc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#afkfmzqecc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#afkfmzqecc .gt_spanner_row {
  border-bottom-style: hidden;
}

#afkfmzqecc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#afkfmzqecc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#afkfmzqecc .gt_from_md > :first-child {
  margin-top: 0;
}

#afkfmzqecc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#afkfmzqecc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#afkfmzqecc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#afkfmzqecc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#afkfmzqecc .gt_row_group_first td {
  border-top-width: 2px;
}

#afkfmzqecc .gt_row_group_first th {
  border-top-width: 2px;
}

#afkfmzqecc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#afkfmzqecc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#afkfmzqecc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#afkfmzqecc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#afkfmzqecc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#afkfmzqecc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#afkfmzqecc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#afkfmzqecc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#afkfmzqecc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#afkfmzqecc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#afkfmzqecc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#afkfmzqecc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#afkfmzqecc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#afkfmzqecc .gt_left {
  text-align: left;
}

#afkfmzqecc .gt_center {
  text-align: center;
}

#afkfmzqecc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#afkfmzqecc .gt_font_normal {
  font-weight: normal;
}

#afkfmzqecc .gt_font_bold {
  font-weight: bold;
}

#afkfmzqecc .gt_font_italic {
  font-style: italic;
}

#afkfmzqecc .gt_super {
  font-size: 65%;
}

#afkfmzqecc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#afkfmzqecc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#afkfmzqecc .gt_indent_1 {
  text-indent: 5px;
}

#afkfmzqecc .gt_indent_2 {
  text-indent: 10px;
}

#afkfmzqecc .gt_indent_3 {
  text-indent: 15px;
}

#afkfmzqecc .gt_indent_4 {
  text-indent: 20px;
}

#afkfmzqecc .gt_indent_5 {
  text-indent: 25px;
}

#afkfmzqecc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#afkfmzqecc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">FHEIGHT</td>
<td class="gt_row gt_center" headers="estimate">0.12</td>
<td class="gt_row gt_center" headers="conf.low">0.09, 0.15</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">No. Obs.</td>
<td class="gt_row gt_center" headers="estimate" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">150</td>
<td class="gt_row gt_center" headers="conf.low" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="p.value" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">R²</td>
<td class="gt_row gt_center" headers="estimate">0.254</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
</div>
<p><strong>Conclusion</strong></p>
<p>Each 1cm increase in height of a father is associated with a significant increase of 0.118 (0.09, 0.15) L of FEV1 (p&lt;.0001). Height explains 25.4% of the variation in FEV1.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/norcalbiostat\.github\.io\/MATH615");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This site is built with 💚 and <a href="https://quarto.org/">Quarto</a> by <a href="www.norcalbiostat.com">Robin Donatello</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/norcalbiostat/MATH615/edit/main/slides/lec08-slr.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/norcalbiostat/MATH615/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>