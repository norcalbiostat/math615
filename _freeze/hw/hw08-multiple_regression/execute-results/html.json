{
  "hash": "17e48de0c73a28f77cb0a7cdb4f5d7c2",
  "result": {
    "markdown": "---\ntitle: \"HW 08: Fitting Multiple Regression models\"\nexecute:\n  echo: true\n  warning: false\n  message: false\n  cache: true\n---\n\n\n# Purpose\nPractice fitting and interpreting different types of multiple regression models. \n\n# Assignment Overview\n\nYou will perform <span style=\"color:blue\">4</span> regression analyses in this assignment. \n\n1. Multiple Linear Regression: $Y \\sim X_{1} + X_{2}$. \n    - Use at least one quantitative and one binary predictor. \n2. Multiple Linear Regression with a categorical predictor: $Y \\sim X_{1} + X_{2} \\ldots X_{p}$. \n    - Use at least one quantitative and one categorical predictor. \n    - You do _not_ need to test for a confounder here. \n3. Logistic Regression: $logit(Y) \\sim X_{1} + X_{2}$. \n    - $X_{1}$ and $X_{2}$ can be of any data type. \n    - Your binary response variable $Y$ must be coded as numeric 1 (event) and 0 (non-event).\n4. Regression on a log transformed outcome: $ln(Y) \\sim X_{1} + X_{2}$. \n    - $X_{1}$ and $X_{2}$ can be of any data type. \n\n# General Instructions\n\n1. Identify variables under consideration\n2. Write out the null, alternative, and confounder Hypotheses statements.\n    - **Null** - that there is no relationship between response and explanatory variables\n    - **Alternative** - that there is a relationship between response and explanatory variables.\n    - **Confounder** - that there is a relationship between response and explanatory variables after controlling for the confounding variable.\n3. Visualize and describe the relationships between the three variables under consideration\n4. Fit the simple bivariate model\n    - Model the response variable on the explanatory variable `y ~ x`\n    - Write a simple sentence on whether or not there is a relationship between x and y.\n5. Fit the multivariable model. \n    - Model the response variable on the explanatory variable and the third variable. `y ~ x + z`\n    - Write out the mathematical model\n    - If the relationship between x and y was significant, then determine if $Z$ is a confounder.\n6. Assess model fit by examining the residuals. \n7. Interpret ALL regression coefficients (including the intercept) in a sentence that includes a confidence interval. \n    - For the Logistic Regression, interpret the Odds Ratio (not the regression coefficient directly)\n8. Write a conclusion. \n    - For linear and log-linear regressions also include an interpretation of the coefficient of determination in this conclusion. \n\nThe **INSTRUCTIONS** differ slightly for each model. Read the examples below carefully and follow all steps. \n\n----\n\n# Submission instructions\n\n* Use the template provided: [[QMD]](_templates/hw08_multiple_regression_template.qmd). Rename this file to `multreg_userid`\n* Upload your draft **PDF** of your work to the `08 Multiple Regression/draft` folder in Google Drive\n\n### Peer Review instructions\n\nAs a reviewer, this is what you're checking for: \n\n* Did they complete all steps? Check each question against the template. \n* Are the graphics, summary statistics and analysis appropriate? \n* Is the final conclusion in plain english with no statistical jargon? \n* Does their conclusion match the output of their statistical program? \n\n## Final\n\n* Upload your final **PDF** to `08 Multiple Regression/final` folder in Google Drive.\n\n\n----\n\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-1_35d56efea5d999e516fd324d1c7f29a5'}\n\n```{.r .cell-code}\nlibrary(dplyr);library(ggplot2); library(scales)\nlibrary(gtsummary); library(broom);library(performance)\n\nload(\"C:/Box/Data/AddHealth/addhealth_clean.Rdata\")\n```\n:::\n\n\n# Multiple Linear Regression\n\n## 1. Identify variables\n\n**If you have a likert “Strongly Agree” to “Strongly Disagree” variable that has at least 5 levels you can treat it as a pseudo-Quantitative Variable for this assignment.**\n\n* Quantitative outcome: Income (variable `income`). \n* Quantitative predictor: Time you wake up in the morning (variable `wakeup`)\n* Binary confounder: Gender (variable `female_c`). This variable is 1 if female, 0 if male. \n \n\n## 2. State hypotheses\n\n* Null: There is no relationship between the time you wake up and your personal earnings\n* Alternative: There is a relationship between the time you wake up and your personal earnings\n* Confounder:  There is still a relationship between the time you wake up and your personal earnings, after controlling for gender. \n\n## 3. Visualize and describe the relationships. Make a statement whether or not you think a relationship exists. \n\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-2_156772062f89beef90f04d075a74a23c'}\n\n```{.r .cell-code}\nggplot(addhealth, aes(x=wakeup, y = income, color = female_c)) + \n  geom_point() + geom_smooth() + theme_bw()\n```\n\n::: {.cell-output-display}\n![](hw08-multiple_regression_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nThere appears to be a flat, and somewhat linear trend between the time someone wakes up and their income. The trend for males looks slightly different than for females. A linear model may not be the best fit for this relationship given the skewness that is present in both income and wakeup time. Since the trend is flat, I do not expect there to be a significant slope between wake up time and income. I also expect that there may be a significant impact of gender on income given how much higher the male trend line is compared to the female trend line.  \n\n\n## 4. Fit the simple model\nIs there a relationship between income and time a person wakes up? \n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-3_dfbdc657f276728ca5589a651aa55019'}\n\n```{.r .cell-code}\nlm.mod1 <- lm(income ~ wakeup, data=addhealth) \ntidy(lm.mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic   p.value\n  <chr>          <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)   43548.     1126.     38.7  3.03e-276\n2 wakeup         -488.      151.     -3.22 1.27e-  3\n```\n:::\n:::\n\n\nThe estimate of the regression coefficient for `wakeup` is significant (b1=-488, p= 0.001). There is reason to believe that the time you wakeup is associated with your income. \n\n\n## 5. Fit the multivariable model, write the mathematical model.\n\n**Fit the same multiple linear regression model and include the potential confounding variable. Determine if the third variable is a confounder. **\n\n\n* Let $y$ be `income`\n* Let $x_{1}$ be time when someone wakes up `wakeup`\n* Let $x_{2}=1$ when `female_c = 1`, and 0 otherwise,\n\n\n$$y = \\beta_{0} + \\beta_{1}x_{1} + \\beta_{2}x_{2}$$\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-4_c518efbbedef56bdf37ee99431e0dcda'}\n\n```{.r .cell-code}\nlm.mod2 <- lm(income ~ wakeup + female_c, data=addhealth) \ntidy(lm.mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n  term           estimate std.error statistic   p.value\n  <chr>             <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)      48669.     1207.     40.3  2.06e-296\n2 wakeup            -611.      149.     -4.09 4.37e-  5\n3 female_cFemale   -8527.      789.    -10.8  8.09e- 27\n```\n:::\n:::\n\n\nThe relationship between income and wake up time is still significant after controlling for gender. Gender is **not** a confounder. \n\n## 6. Assess model fit\n\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-5_2347e97746b481b834dd35049843ca1f'}\n\n```{.r .cell-code}\ncheck_model(lm.mod2)\n```\n\n::: {.cell-output-display}\n![](hw08-multiple_regression_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nThis model doesn't fit the data incredibly well. The residuals are somewhat not normal, with predicted income higher than the observed. There is indication of non-constant variance as well, there is a quadratic trend to the standardized residuals when the fitted income is above 40k. \n\n\n## 7. Interpret the regression coefficients of the multivariable model.\n\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-6_e8061b14edbaca9f89fd165eafcdd970'}\n\n```{.r .cell-code}\ntbl_regression(lm.mod2, intercept = TRUE) %>% \n   add_glance_table(include = c(adj.r.squared))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"whqfkrwioj\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#whqfkrwioj .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#whqfkrwioj .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#whqfkrwioj .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#whqfkrwioj .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#whqfkrwioj .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#whqfkrwioj .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#whqfkrwioj .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#whqfkrwioj .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#whqfkrwioj .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#whqfkrwioj .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#whqfkrwioj .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#whqfkrwioj .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#whqfkrwioj .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#whqfkrwioj .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#whqfkrwioj .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#whqfkrwioj .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#whqfkrwioj .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#whqfkrwioj .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#whqfkrwioj .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#whqfkrwioj .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#whqfkrwioj .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#whqfkrwioj .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#whqfkrwioj .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#whqfkrwioj .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#whqfkrwioj .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#whqfkrwioj .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#whqfkrwioj .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#whqfkrwioj .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#whqfkrwioj .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#whqfkrwioj .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#whqfkrwioj .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#whqfkrwioj .gt_left {\n  text-align: left;\n}\n\n#whqfkrwioj .gt_center {\n  text-align: center;\n}\n\n#whqfkrwioj .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#whqfkrwioj .gt_font_normal {\n  font-weight: normal;\n}\n\n#whqfkrwioj .gt_font_bold {\n  font-weight: bold;\n}\n\n#whqfkrwioj .gt_font_italic {\n  font-style: italic;\n}\n\n#whqfkrwioj .gt_super {\n  font-size: 65%;\n}\n\n#whqfkrwioj .gt_two_val_uncert {\n  display: inline-block;\n  line-height: 1em;\n  text-align: right;\n  font-size: 60%;\n  vertical-align: -0.25em;\n  margin-left: 0.1em;\n}\n\n#whqfkrwioj .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#whqfkrwioj .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#whqfkrwioj .gt_slash_mark {\n  font-size: 0.7em;\n  line-height: 0.7em;\n  vertical-align: 0.15em;\n}\n\n#whqfkrwioj .gt_fraction_numerator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: 0.45em;\n}\n\n#whqfkrwioj .gt_fraction_denominator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: -0.05em;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\"><strong>Beta</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\"><strong>95% CI</strong><sup class=\"gt_footnote_marks\">1</sup></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\"><strong>p-value</strong></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">(Intercept)</td>\n<td class=\"gt_row gt_center\">48,669</td>\n<td class=\"gt_row gt_center\">46,303, 51,036</td>\n<td class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td class=\"gt_row gt_left\">wakeup</td>\n<td class=\"gt_row gt_center\">-611</td>\n<td class=\"gt_row gt_center\">-904, -318</td>\n<td class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td class=\"gt_row gt_left\">female_c</td>\n<td class=\"gt_row gt_center\"></td>\n<td class=\"gt_row gt_center\"></td>\n<td class=\"gt_row gt_center\"></td></tr>\n    <tr><td class=\"gt_row gt_left\" style=\"text-align: left; text-indent: 10px;\">Male</td>\n<td class=\"gt_row gt_center\">—</td>\n<td class=\"gt_row gt_center\">—</td>\n<td class=\"gt_row gt_center\"></td></tr>\n    <tr><td class=\"gt_row gt_left\" style=\"text-align: left; text-indent: 10px;\">Female</td>\n<td class=\"gt_row gt_center\">-8,527</td>\n<td class=\"gt_row gt_center\">-10,075, -6,980</td>\n<td class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td class=\"gt_row gt_left\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">Adjusted R²</td>\n<td class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">0.032</td>\n<td class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"></td>\n<td class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"></td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><sup class=\"gt_footnote_marks\">1</sup> CI = Confidence Interval</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n\n\n* $b_{0}$: For a male (`gender=0`) who wakes up at midnight (`wakeup=0`), their predicted average income is \\$48,669.4 (95% CI \\$46,303.9, \\$51,035)\n* $b_{1}$: Holding gender constant, for every hour later a person wakes up, their predicted average income drops by \\$611 (95% CI \\$319, \\$904). \n* $b_{2}$: Controlling for the time someone wakes up in the morning, the predicted average income for females is \\$8,527 (95% CI \\$6,980, \\$10,074) lower than for males. \n\n## 8. Write a templated conclusion\n\n**Use the numerical results from the multivariable model to fill in the values in the conclusion below. Replace the bold words with your variables, the `highlighted` words with data from your analysis, and choose between _conclusion options_.** \n\n\nAfter adjusting for the potential confounding factor of **third variable**, **explanatory variable** (b1 = `parameter estimate, CI confidence interval range, p = significance value`) was ***significantly/not significantly** and **positively/negatively** associated with **response variable**. Approximately `R-Square*100` of the variance of **response** can be accounted for by **explanatory** after controlling for **third variable**. Based on these analyses, **third variable** _is not/is_ a confounding factor because the association between **explanatory** and **response** _is still/is no longer_ significant after accounting for **third variable**. \n\nSo the conclusion for this analysis reads: \n\n> After adjusting for the potential confounding factor of **gender**, **wake up time** ($b_{1}$ = `-611, 95% CI: (-904, -318), p<.0001`) was **significantly** and **negatively** associated with **income**. Approximately `3.2%` of the variance of **income** can be accounted for by **wake up time** after controlling for **gender**. Based on these analyses, **gender** _is not_ a confounding factor because the association between **wake up time** and **income** _is still_ significant after accounting for **gender**.\n\nAfter wordsmithing/editing for sentence flow, \n\n> After adjusting for the potential confounding factor of gender, an adolescent’s weight (Beta = 1.34, 95% CI -0.53, 3.21, p = .1558) was not significantly associated with the number of cigarettes smoked in the past 30 days. Approximately 0.78% of the variance in cigarettes smoked can be accounted for by weight after controlling for gender. Based on these analyses, gender is a confounding factor because the association between weight and cigarettes smoked is no longer significant after accounting for gender. \n\n-----\n\n\n# Multiple Linear Regression with a Categorical Predictor\n\n### 1. Identify variables\n* Outcome: BMI (variable `BMI`). This is a quantitative measure. \n* Predictor: Income (variable `income`). This is a quantitative measure. \n* Predictor: general health (variable `genhealth`). This is a categorical measure with levels: Excellent (reference), Very good, Good, Fair and Poor.  \n\n\n## 2. Visualize and describe the relationships. Make a statement whether or not you think a relationship exists. \n\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-7_e6d4433ca1b0a8dbf8c5704a43adfaa9'}\n\n```{.r .cell-code}\nggplot(addhealth, aes(x=income, y = BMI, color = genhealth)) + \n  geom_point() + geom_smooth() + theme_bw()\n```\n\n::: {.cell-output-display}\n![](hw08-multiple_regression_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nThere is a lot of clustering in the lower left corner of the scatterplot between income and BMI. The relationship between income and BMI seem the same for all general health categories, although it is noteworthy that no one that reported having poor health reported an income over \\$75,000. I do not expect there to be a significant relationship between income and BMI, but I do expect there to be a significant difference in BMI across general health category groups. \n\n\n### 3. Fit the multivariable model. \n**Define what each $x$ is, and write the mathematical model. State what group is the reference group.**\n\n* Let $y$ be `BMI`\n* Let $x_{1}$ be `income`\n* Let $x_{2}=1$ when `genhealth='Very good'`, and 0 otherwise,\n* let $x_{3}=1$ when `genhealth='Good'`, and 0 otherwise,\n* let $x_{4}=1$ when `genhealth='Fair'`, and 0 otherwise,\n* let $x_{5}=1$ when `genhealth='Poor'`, and 0 otherwise. \n\nThe reference group for `genhealth` is `Excellent`. \n\nThe mathematical model would look like: \n\n\n$$ Y \\sim \\beta_{0} + \\beta_{1}*x_{1} + \\beta_{2}x_{2} + \\beta_{3}x_{3} + \\beta_{4}x_{4} + \\beta_{5}x_{5} $$\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-8_8a45f48f8ee2505495618b0deb90e66f'}\n\n```{.r .cell-code}\ngh.model <- lm(BMI~income + genhealth, data=addhealth)\nsummary(gh.model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = BMI ~ income + genhealth, data = addhealth)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-16.837  -4.802  -1.091   3.441  39.132 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(>|t|)    \n(Intercept)         2.652e+01  3.298e-01  80.409  < 2e-16 ***\nincome             -4.735e-06  4.686e-06  -1.010    0.312    \ngenhealthVery good  1.602e+00  3.100e-01   5.166 2.52e-07 ***\ngenhealthGood       4.758e+00  3.245e-01  14.664  < 2e-16 ***\ngenhealthFair       6.917e+00  5.039e-01  13.726  < 2e-16 ***\ngenhealthPoor       9.350e+00  1.392e+00   6.717 2.13e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.967 on 3771 degrees of freedom\n  (2727 observations deleted due to missingness)\nMultiple R-squared:  0.09217,\tAdjusted R-squared:  0.09096 \nF-statistic: 76.57 on 5 and 3771 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n### 4. Interpret the regression coefficients. \n\n* $b_{0}$: The predicted BMI for individuals with no income and excellent health is 26.5 (25.9, 27.2). \n* $b_{1}$: After controlling for general health, for every additional $1 a person makes annually, their BMI decreases .0000047. This is not a significant relationship. A more meaningful interpretation would be to look at a $1000 increase in annual income. For every additional $1,000,000 in income a person makes annually, their BMI decreases by 4.7.\n* $b_{2}$: Those reporting very good health have 1.6 (0.99, 2.2, p<.0001) higher BMI compared to those reporting excellent health. \n* $b_{3}$:Those reporting good health have 4.8 (4.1, 5.4, p<.0001) higher BMI compared to those reporting excellent health. \n* $b_{4}$: Those reporting fair health have 6.9 (5.9, 7.9, p<.0001) higher BMI compared to those reporting excellent health. \n* $b_{5}$: Those reporting poor health have 9.4 (6.6, 12.1, p<.0001) higher BMI compared to those reporting excellent health. \n\n\n## 5. Assess model fit\n\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-9_461d6c686e3cdf1290cbc7318ce39b44'}\n\n```{.r .cell-code}\ncheck_model(gh.model)\n```\n\n::: {.cell-output-display}\n![](hw08-multiple_regression_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nThis model fits the data The predicted income is still higher than the observed, but perhaps less so compared to the model in the last example. However the non-constant variance is very clear, the variance of the residuals increase as the fitted values increase. \n\n\n### 6. Write a conclusion.\n**Include an interpretation of the coefficient of determination in this conclusion.**\n\nAfter controlling for general health, income is not significantly associated with BMI. Because each level of general health is significantly different from the reference group, we can say that it is also associated with BMI. The average BMI increases as reported general health decreases. General health and income combined explain 9.1% of the variability in BMI. \n\n\n-----\n\n# Logistic Regression\n\n## 1. Identify variables\n\n* Binary outcome: Poverty (variable `poverty`). This is an indicator if reported personal income is below $10,210. \n* Binary predictor: Ever smoked a cigarette (variable `eversmoke_c`)\n* Binary confounder: Gender (variable `female_c`)\n \n\n## 2. State hypotheses\n\n* Null hypothesis: There is no relationship between the probability of living below the poverty level and the time you wake up in the morning. \n* Alternative hypothesis: There is a relationship between the probability of living below the poverty level and the time you wake up in the morning. \n* Confounding hypothesis: There _still is_ a relationship between the probability of living below the poverty level and the time you wake up in the morning after controlling for gender. \n\n## 3. Visualize and describe the relationships. Make a statement whether or not you think a relationship exists. \n\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-10_81130685695086ea4f5df3379a9a7038'}\n\n```{.r .cell-code}\naddhealth %>% \n  select(eversmoke_c, poverty, female_c) %>%\n  na.omit() %>%\n  group_by(eversmoke_c, female_c) %>%\n  summarize(pov.pct = mean(poverty)) %>%\n  ggplot(aes(x=eversmoke_c, y = pov.pct, fill = female_c)) + \n  geom_col(position = position_dodge()) + \n  scale_y_continuous(labels=percent)\n```\n\n::: {.cell-output-display}\n![](hw08-multiple_regression_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nThe percent of individuals living in poverty are higher for females compared to males. There is not much difference in the poverty rates depending on if the individual has ever smoked. I expect there to be a significant relationship between poverty and gender, but not poverty and smoking status. \n\n\n## 3. Fit the simple model\n**Fit the logistic regression model (a.k.a generalized linear model) of the explanatory variable on the response variable. Write a simple statement.**\n\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-11_b9257bbfea01332dadd37b3018d08e36'}\n\n```{.r .cell-code}\nlog.mod.1 <- glm(poverty~eversmoke_c, data=addhealth, family='binomial')\ntidy(log.mod.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 5\n  term                            estimate std.error statistic   p.value\n  <chr>                              <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)                       -1.55     0.0644    -24.0  1.68e-127\n2 eversmoke_cSmoked at least once    0.287    0.0774      3.71 2.07e-  4\n```\n:::\n:::\n\n\nThe p-value for the b1 estimate of the regression coefficient for `eversmoke_c` is significant at 0.0002. There is reason to believe that smoking status is associated with the probability of living below the poverty level. \n\n \n## 4. Fit the multivariable model, write the mathematical model. \n\n**Fit the same logistic regression model and include the potential confounding variable. If the bivariate relationship was significant, additionally determine if the third variable is a confounder.**\n\n* Let $p$ be the probability that a person reported an annual personal income below $10,210.\n* Let $x_{1}$ be 1 for smokers and 0 for non-smokers.\n* Let $x_{2}$ be 1 for females, and 0 for males. \n\n\n$$log(\\frac{p}{1-p}) \\sim \\beta_{0} + \\beta_{1}x_{1} + \\beta_{1}x_{2}$$\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-12_fed1617426ccad92bd0ce2233a04abdc'}\n\n```{.r .cell-code}\nlog.mod.2 <- glm(poverty~eversmoke_c + female_c, data=addhealth, family='binomial')\ntidy(log.mod.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n  term                            estimate std.error statistic   p.value\n  <chr>                              <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)                       -2.14     0.0866    -24.7  8.19e-135\n2 eversmoke_cSmoked at least once    0.387    0.0789      4.91 9.09e-  7\n3 female_cFemale                     0.874    0.0769     11.4  5.82e- 30\n```\n:::\n:::\n\n\nThe p-value for the regression coefficient estimate of `eversmoke_c` is still significant at <.0001 after controlling for gender. Thus gender is **not** a confounder. \n\n\n## 5. Interpret the Odds Ratio estimates\n\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-13_6e37af73b6204dd3cdef935d5dc21cf7'}\n\n```{.r .cell-code}\ntbl_regression(log.mod.2, exponentiate = TRUE)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"vlsvgtabpo\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#vlsvgtabpo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#vlsvgtabpo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vlsvgtabpo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#vlsvgtabpo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#vlsvgtabpo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vlsvgtabpo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vlsvgtabpo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#vlsvgtabpo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#vlsvgtabpo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#vlsvgtabpo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#vlsvgtabpo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#vlsvgtabpo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vlsvgtabpo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vlsvgtabpo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#vlsvgtabpo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#vlsvgtabpo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#vlsvgtabpo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vlsvgtabpo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#vlsvgtabpo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#vlsvgtabpo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vlsvgtabpo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#vlsvgtabpo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#vlsvgtabpo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vlsvgtabpo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vlsvgtabpo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#vlsvgtabpo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#vlsvgtabpo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vlsvgtabpo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vlsvgtabpo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vlsvgtabpo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vlsvgtabpo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vlsvgtabpo .gt_left {\n  text-align: left;\n}\n\n#vlsvgtabpo .gt_center {\n  text-align: center;\n}\n\n#vlsvgtabpo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#vlsvgtabpo .gt_font_normal {\n  font-weight: normal;\n}\n\n#vlsvgtabpo .gt_font_bold {\n  font-weight: bold;\n}\n\n#vlsvgtabpo .gt_font_italic {\n  font-style: italic;\n}\n\n#vlsvgtabpo .gt_super {\n  font-size: 65%;\n}\n\n#vlsvgtabpo .gt_two_val_uncert {\n  display: inline-block;\n  line-height: 1em;\n  text-align: right;\n  font-size: 60%;\n  vertical-align: -0.25em;\n  margin-left: 0.1em;\n}\n\n#vlsvgtabpo .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#vlsvgtabpo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#vlsvgtabpo .gt_slash_mark {\n  font-size: 0.7em;\n  line-height: 0.7em;\n  vertical-align: 0.15em;\n}\n\n#vlsvgtabpo .gt_fraction_numerator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: 0.45em;\n}\n\n#vlsvgtabpo .gt_fraction_denominator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: -0.05em;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\"><strong>OR</strong><sup class=\"gt_footnote_marks\">1</sup></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\"><strong>95% CI</strong><sup class=\"gt_footnote_marks\">1</sup></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\"><strong>p-value</strong></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">eversmoke_c</td>\n<td class=\"gt_row gt_center\"></td>\n<td class=\"gt_row gt_center\"></td>\n<td class=\"gt_row gt_center\"></td></tr>\n    <tr><td class=\"gt_row gt_left\" style=\"text-align: left; text-indent: 10px;\">Never Smoked</td>\n<td class=\"gt_row gt_center\">—</td>\n<td class=\"gt_row gt_center\">—</td>\n<td class=\"gt_row gt_center\"></td></tr>\n    <tr><td class=\"gt_row gt_left\" style=\"text-align: left; text-indent: 10px;\">Smoked at least once</td>\n<td class=\"gt_row gt_center\">1.47</td>\n<td class=\"gt_row gt_center\">1.26, 1.72</td>\n<td class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td class=\"gt_row gt_left\">female_c</td>\n<td class=\"gt_row gt_center\"></td>\n<td class=\"gt_row gt_center\"></td>\n<td class=\"gt_row gt_center\"></td></tr>\n    <tr><td class=\"gt_row gt_left\" style=\"text-align: left; text-indent: 10px;\">Male</td>\n<td class=\"gt_row gt_center\">—</td>\n<td class=\"gt_row gt_center\">—</td>\n<td class=\"gt_row gt_center\"></td></tr>\n    <tr><td class=\"gt_row gt_left\" style=\"text-align: left; text-indent: 10px;\">Female</td>\n<td class=\"gt_row gt_center\">2.40</td>\n<td class=\"gt_row gt_center\">2.06, 2.79</td>\n<td class=\"gt_row gt_center\"><0.001</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><sup class=\"gt_footnote_marks\">1</sup> OR = Odds Ratio, CI = Confidence Interval</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n\n\n\n* After controlling for gender, smokers have 1.5 (1.3, 1.7) times the odds of reporting making below the federal poverty level compared to non smokers. \n* After controlling for smoking status, females have 2.4 (2.1, 2.8) time the odds of reporting annual earned wages below the federal poverty level compared to males.\n\n\n## 6. Template Conclusion\n\n**Replace the bold words with your variables, the `highlighted` words with data from your analysis, and choose between _conclusion options_.**\n\n\nAfter adjusting for the potential confounding factor of **third variable**, **explanatory variable** (`OR odds ratio estimate, CI confidence interval range, p = significance value`) was _significantly/not significantly_ and _positively/negatively_ associated with the likelihood of **response variable**. In this analysis, the odds ratio tells us that those who are **[describe what dummy code 1 of your explanatory variable means here]** are `0.05` times _more (if OR greater than 1)/less (if OR less than 1)_ likely to **[describe what dummy code 1 of your response variable means here]**.  Based on these analyses, **third variable** _is not/is_ a confounding factor because the association between **explanatory** and **response** _is still/is no longer_ significant after accounting for **third variable**. \n\nSo the conclusion for this analysis reads:\n\nAfter adjusting for the potential confounding factor of **gender**, **smoking status** (`1.47, CI 1.26-1.72, p <.0001`) was _significantly_ and _positively_ associated with the likelihood of **earning under the poverty level**. In this analysis, the odds ratio tells us that those who **have ever smoked** are `1.47` times _more_ likely to **earn income below the federal poverty level**.  Based on these analyses, **gender** _is not_ a confounding factor because the association between **smoking** and **poverty status** _is still_ significant after accounting for **gender**. \n\n\n----\n\n# Log Transformed Response \n\n### 1. Identify variables\nIn the first example modeling income based on wakeup time and gender the model didn't fit the data well and I believe it may be related to the skewness of the income measure. So in this analysis I will log transform income and model that as the outcome. \n\n* Quantitative outcome that has been log transformed: Income (variable `logincome`)\n* Quantitative predictor: Time you wake up in the morning (variable `wakeup`)\n* Binary confounder: Gender (variable `female_c`)\n \n \n### 2. State hypothesis\n* Null hypothesis: There is no relationship between the time you wake up in the morning and your income level\n* Alternative hypothesis: There is a relationship between the time you wake up in the morning and your income level.\n* Confounding hypothesis: There _still is_ a relationship between the time you wake up in the morning and your income, after controlling for gender. \n\n## 3. Visualize and describe the relationships. Make a statement whether or not you think a relationship exists. \n\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-14_e0527ffc2f6cefeaddba152127e11dc4'}\n\n```{.r .cell-code}\nggplot(addhealth, aes(x=wakeup, y = logincome, color = female_c)) + \n  geom_point() + geom_smooth() + theme_bw()\n```\n\n::: {.cell-output-display}\n![](hw08-multiple_regression_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nThe relationship looks the same as it did in the first example. This shouldn't be much of a surprise since all log transforming does is shift the distribution to the higher values. \n\n\n### 4. Fit the multivariable model, write the mathematical model. \n\n\n$$ln(Y) \\sim \\beta_{0} + \\beta_{1}x_{1} + \\beta_{2}x_{2}$$\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-15_c05af3c28a5530a478b43e7d2a8dbcdd'}\n\n```{.r .cell-code}\nln.mod.2 <- lm(logincome~wakeup + female_c, data=addhealth)\nsummary(ln.mod.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = logincome ~ wakeup + female_c, data = addhealth)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.32215 -0.33473 -0.00461  0.34058  2.01559 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    10.653062   0.025995 409.805  < 2e-16 ***\nwakeup         -0.014907   0.003218  -4.633 3.73e-06 ***\nfemale_cFemale -0.192710   0.017000 -11.336  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.5233 on 3810 degrees of freedom\n  (2691 observations deleted due to missingness)\nMultiple R-squared:  0.03611,\tAdjusted R-squared:  0.0356 \nF-statistic: 71.36 on 2 and 3810 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nThere is still significant relationship between the time someone wakes up and the natural log of their income. \n\n## 5. Assess model fit\n\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-16_f3b46d82534b23c63bf8160fb3d6b126'}\n\n```{.r .cell-code}\ncheck_model(ln.mod.2)\n```\n\n::: {.cell-output-display}\n![](hw08-multiple_regression_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nThe model fit has improved! The predicted distribution matches the observed data better, the residuals are more normally distributed. Noteworthy that the lack of homogeneity of variance is still somewhat present, but not nearly at the extent from the non-transformed variable. \n\n\n### 6. Interpret the regression coefficients.\n\n::: {.cell hash='hw08-multiple_regression_cache/html/unnamed-chunk-17_7492f48b78a3d6e93870d8f1ef0bbd75'}\n\n```{.r .cell-code}\n1-exp(coef(ln.mod.2)[-1])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        wakeup female_cFemale \n    0.01479693     0.17527851 \n```\n:::\n\n```{.r .cell-code}\n1-exp(confint(ln.mod.2)[-1,])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                    2.5 %      97.5 %\nwakeup         0.02099299 0.008561652\nfemale_cFemale 0.20231394 0.147326777\n```\n:::\n:::\n\n\n* For every hour later one wakes up in the morning, one can expect to earn `1-exp(-0.015)` = 1.4% less income than someone who wakes up one hour earlier. This is after controlling for gender. \n* Females have on average `1-exp(-0.19)` = 17% percent lower income than males, after controlling for the wake up time. \n\n\n### 7. Conclusion\n\nBoth gender and time one wakes up are significantly associated with the amount of personal earnings one makes. Waking up later in the morning is associated with 1.4% (95% CI 0.8%-2%, p<.0001) percent lower income than someone who wakes up one hour earlier. Females have 17% (95% CI 15%-20%, p<.0001) percent lower income than males. Time that someone wakes up and their gender explain 3.6\\% of the variability in someones annual income. \n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}