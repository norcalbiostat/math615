{
  "hash": "7eb39f8e7a1b356dc5714b323a38312e",
  "result": {
    "markdown": "---\ntitle: \"Multiple Regression & Confonding\"\ndate: \"2023-11-06\"\ndescription: \"12\"\n---\n\n\n\n# Setup\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nlibrary(tidyverse)   # general use\nlibrary(performance) # model diagnostics\nlibrary(gtsummary)   # regression tables\nlibrary(broom)       # tidy regression output\n\npen <- palmerpenguins::penguins\nfev <- read.delim(\"https://norcalbiostat.netlify.com/data/Lung_081217.txt\", sep=\"\\t\", header=TRUE)\nload(\"C:/Box/Data/AddHealth/addhealth_clean.Rdata\")\n#load(\"C:/Users/rdonatello/Box/Data/AddHealth/addhealth_clean.Rdata\")\n```\n:::\n\n\n\n## Motivation\n\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nggplot(fev, aes(y=FFEV1, x=FHEIGHT)) + geom_point() + \n      xlab(\"Height\") + ylab(\"FEV1\") + \n      ggtitle(\"Relationship between FEV1 and Height of Fathers.\") + \n      geom_smooth(method=\"lm\", se=FALSE, col=\"blue\") + \n      geom_smooth(se=FALSE, col=\"red\") + \n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](lec09-mlr_confounding_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(fev, aes(y=FFEV1, x=FAGE)) + geom_point() + \n      xlab(\"Age\") + ylab(\"FEV1\") + \n      ggtitle(\"Relationship between FEV1 and Age of Fathers.\") + \n      geom_smooth(method=\"lm\", se=FALSE, col=\"blue\") + \n      geom_smooth(se=FALSE, col=\"red\") + \n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](lec09-mlr_confounding_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\n\n-   There appears to be a tendency for taller men to have higher FEV1, but FEV1 also decreases with age.\n-   We need to have a robust model that can incorporate information from multiple variables at the same time.\n\n## MLR Framework\n\n-   Multiple linear regression is our tool to expand our MODEL to better fit the DATA.\n-   Describes a *linear relationship* between a single continuous $Y$ variable, and several $X$ variables.\n-   Models $Y$ from $X_{1}, X_{2}, \\ldots , X_{P}$.\n-   X's can be continuous or discrete (categorical)\n-   X's can be transformations of other X's, e.g., $log(x), x^{2}$.\n\n## Visualization\n\nNow it's no longer a 2D regression *line*, but a $p$ dimensional regression plane.\n\n![A regression plane in 3 dimensions: $FEV1 \\sim Height + Age$](images/regression_plane.png){width=\"603\"}\n\n\n## Mathematical Model\n\nThe mathematical model for multiple linear regression equates the value of the continuous outcome $y_{i}$ to a **linear combination** of multiple predictors $x_{1} \\ldots x_{p}$ each with their own slope coefficient $\\beta_{1} \\ldots \\beta_{p}$. \n\n$$ y_{i} = \\beta_{0} + \\beta_{1}x_{1i} + \\ldots + \\beta_{p}x_{pi} + \\epsilon_{i}$$\n\nwhere $i$ indexes the observations $i = 1 \\ldots n$, and $j$ indexes the number of parameters $j=1 \\ldots p$.\n\n## Assumptions \n\nThe assumptions on the residuals $\\epsilon_{i}$ still hold:   \n\n* They have mean zero  \n* They are homoscedastic, that is all have the same finite variance: $Var(\\epsilon_{i})=\\sigma^{2}<\\infty$  \n* Distinct error terms are uncorrelated: (Independent) $\\text{Cov}(\\epsilon_{i},\\epsilon_{j})=0,\\forall i\\neq j.$  \n\n\n## Parameter Estimation\n\nFind the values of $b_j$ that minimize the difference between the value of the dependent variable predicted by the model $\\hat{y}_{i}$ and the true value of the dependent variable $y_{i}$.\n\n$$ \\hat{y_{i}} - y_{i}$$\n\nwhere the predicted values $\\hat{y}_{i}$ are calculated as \n\n$$\\hat{y}_{i}  = \\sum_{i=1}^{p}X_{ij}b_{j}$$\n\nMinimize: \n\n$$ \\sum_{i=1}^{n} (y_{i} - \\sum_{i=1}^{p}X_{ij}b_{j})^{2}$$\n\n\n## Fitting the model\n\nFitting a regression model in R with more than 1 predictor is done by adding each variable to the right hand side of the model notation connected with a `+`. \n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nlm(FFEV1 ~ FAGE + FHEIGHT, data=fev)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = FFEV1 ~ FAGE + FHEIGHT, data = fev)\n\nCoefficients:\n(Intercept)         FAGE      FHEIGHT  \n   -2.76075     -0.02664      0.11440  \n```\n:::\n:::\n\n\n\n* Each $\\beta_{j}$ coefficient is considered a slope. \n    - The amount $Y$ will change for every 1 unit increase in $X_{j}$. \n* In a multiple variable regression model, $\\b_{j}$ is the estimated change in $Y$ _after controlling for other predictors in the model_. \n\n\n## Interpreting Coefficients\n\n* _Holding height constant_, for every 10 year increase in age, FEV1 decreases by 2.6L\n* _Holding age constant_, for every 1cm increase in height, the FEV1 increases by 11.4L. \n\n\n",
    "supporting": [
      "lec09-mlr_confounding_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}