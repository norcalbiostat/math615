{
  "hash": "f10b1a9366c7fc21e8519cf155445da8",
  "result": {
    "markdown": "---\ntitle: \"Simple Linear Regression\"\ndate: \"2023-10-23\"\ndescription: \"10\"\n---\n\n\n\n\n\n# Always visualized before you model\n\n![Anscombs Quartet are four datasets have the same correlation value and similar slope of the regression line.](images/ansQtet.png){fig-align=\"center\"}\n\nSo does this [datasaurus](https://www.openintro.org/blog/article/2021-10-17-summary-statistics-and-the-datasaurus-dozen/)! \n\n## Overview\n\nThe general purpose of regression is to learn more about the relationship between several independent or predictor variables and a quantitative dependent variable.\n\nThe goal of *Simple linear regression* is to describe the relationship between a continuous dependent variable Y and a single independent continuous variable X using a straight line.\n\n# External Instructional Notes\n\n:::{.callout-important}\n### Applied Stats Course Notes\nSee [ASCN Ch 7](https://norcalbiostat.github.io/AppliedStatistics_notes/slr.html) for the learning content.\n:::\n\nThese slides contain an example of a full 5 step analysis. \n \n## Example: Body mass and bill length of penguins\n\n### 1. Identify response and explanatory variables\n\n-   The quantitative explanatory variable is body mass (g)\n-   The quantitative response variable is bill length (mm)\n\n## 2. Visualize and summarise bivariate relationship {.smaller}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pen, aes(x=body_mass_g, y=bill_length_mm)) + \n  geom_point() + geom_smooth(col = \"red\")\n```\n\n::: {.cell-output-display}\n![](lec07c-regression_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\nThere is a strong, positive, mostly linear relationship between the body mass (g) of penguins and their bill length (mm) (r=.595).\n\n## 3. Write the relationship you want to examine in the form of a research question.\n\n-   Null Hypothesis: There is no linear relationship between body mass and bill length.\n-   Alternate Hypothesis: There is a linear relationship between body mass and bill length.\n\n## 4. Perform an appropriate statistical analysis using Dr D's 4 step method.\n\n**a. Define parameters** Let $\\beta_1$ be the true slope parameter that describes the change in bill length of the penguin as body mass increases.\n\n**b. State the null and alternative hypothesis as symbols**\n\n$H_{0}: \\beta_{1}=0 \\qquad \\qquad H_{A}: \\beta_{1} \\neq 0$\n\n## c. State and justify the analysis model.\n\nBoth the outcome and predictor are continuous variables that have a visible linear relationship, and observations are independent.\n\nThe rest of the model assumptions can be checked after the model is fit using the `check_model(my_model_object_name)` function from the `performance` package.\n\n## d. Conduct the analysis and write a conclusion. {.smaller}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npen.body.bill <- lm(bill_length_mm ~ body_mass_g, data=pen)\npen.body.bill |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = bill_length_mm ~ body_mass_g, data = pen)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-10.1251  -3.0434  -0.8089   2.0711  16.1109 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 2.690e+01  1.269e+00   21.19   <2e-16 ***\nbody_mass_g 4.051e-03  2.967e-04   13.65   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.394 on 340 degrees of freedom\n  (2 observations deleted due to missingness)\nMultiple R-squared:  0.3542,\tAdjusted R-squared:  0.3523 \nF-statistic: 186.4 on 1 and 340 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n\nThe p-value for $b_{1}$ is \\<.0001, so there is sufficient evidence to believe that there is a linear relationship between body mass and bill length.\n\n## c (_cont_). Finish checking the assumptions {.smaller}\n\nThis section uses functions from the `performance` package. \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nlibrary(performance)\n```\n:::\n\n\n\n## Assumption: Normality of residuals \n\n::: columns\n::: {.column width=\"40%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(check_normality(pen.body.bill))\n```\n\n::: {.cell-output-display}\n![](lec07c-regression_files/figure-html/unnamed-chunk-5-1.png){width=384}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"60%\"}\nThe distribution of the residuals is mostly normal, pretty heavy right tail. This is indicative of a nonlinear trend somewhere in the data.\n:::\n:::\n\n## Assumption: Normality of residuals\n\n::: columns\n::: {.column width=\"40%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(check_normality(pen.body.bill), type = \"qq\")\n```\n\n::: {.cell-output-display}\n![](lec07c-regression_files/figure-html/unnamed-chunk-6-1.png){width=384}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"60%\"}\nThis is also known as a 'normal probability plot' or a 'qqplot'. It is used to compare the theoretical quantiles of the data *if it were to come from a normal distribution* to the observed quantiles. PMA6 Figure 5.4 has more examples and an explanation.\n:::\n:::\n\n## Assumption: Homogeneity of variance\n\n::: columns\n::: {.column width=\"40%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(check_heteroskedasticity(pen.body.bill))\n```\n\n::: {.cell-output-display}\n![](lec07c-regression_files/figure-html/unnamed-chunk-7-1.png){width=384}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"60%\"}\nHoly non-flat relationship Batman. The variance of Y is not constant. This is a warning that our linear model does *not* fit the data well and we should look into possible refinements and improvements.\n:::\n:::\n\n## Model-check Posterior Predictions {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(check_posterior_predictions(pen.body.bill))\n```\n\n::: {.cell-output-display}\n![](lec07c-regression_files/figure-html/unnamed-chunk-8-1.png){width=384}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\nThis check compares the distribution of predicted values to the distribution of observed values. \nIn this example the observed distribution of bill length is bimodal, and so the model is overestimating some values and underestimating others. There is clearly some other *confounding* variable that predicts bill length better than just body mass.\n:::\n:::\n\n\n## 5. Write a conclusion in context of the problem. {.smaller}\n\n::: columns\n::: {.column width=\"40%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\npen.body.bill |> coefficients() \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n (Intercept)  body_mass_g \n26.898872424  0.004051417 \n```\n:::\n\n```{.r .cell-code}\npen.body.bill |> confint()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   2.5 %       97.5 %\n(Intercept) 24.402502194 29.395242653\nbody_mass_g  0.003467795  0.004635038\n```\n:::\n\n```{.r .cell-code}\npen.body.bill |> r2()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# R2 for Linear Regression\n       R2: 0.354\n  adj. R2: 0.352\n```\n:::\n:::\n\n\n:::\n\n::: {.column width=\"60%\"}\nEach 1g increase in body mass of a penguin is associated with a significant increase of 0.004 (0.0035, 0.0046) mm of bill length (p\\<.0001).\n\nAn increase of 1kg of body mass in a penguin corresponds to a 4(3.5, 4.6) mm increase in bill length.\n\nBody mass explains 35.4% of the variation in bill length.\n:::\n:::\n\nHowever, model diagnostics indicate that a linear model may not be appropriate for this relationship. The assumption of constant variance is not upheld and there may be another variable that affects bill length.\n",
    "supporting": [
      "lec07c-regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}