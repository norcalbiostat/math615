{
  "hash": "058298660e31fd52f0883198b5759a33",
  "result": {
    "markdown": "---\ntitle: \"Multiple Linear Regression\"\ndate: \"2024-11-04\"\ndescription: \"lec09\"\nfooter: \"[ðŸ”— https://math615.netlify.app](https://math615.netlify.app) / Multiple Linear Regression\"\nfrom: markdown+emoji\nformat: \n  revealjs:\n    theme: sky\n    transition: fade\n    slide-number: true\n    incremental: false \n    chalkboard: true\nexecute:\n  #freeze: auto\n  echo: true\n  message: false\n  warning: false\nknitr:\n  opts_chunk: \n    R.options:\n      width: 200\neditor: \n  markdown: \n    wrap: 72\n---\n\n::: {.cell}\n\n:::\n\n\n\n## Motivation: Life is rarely bivariate. \n\n* We know that the number of steps someone takes per day is not the only thing that is related to someone's BMI. \n    - diet, age, sex, climate they live in, etc. \n* So how can we understand whether or not physical activity is associated with BMI _after controlling for_ these other measures?\n* Consider two people of the same age, living in the same climate, with the same diet, but their level of physical activity is _different_. \n    - Then we can estimate how much physical activity affects someone's BMI\n\n## Need to expand our model\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell layout-nrow=\"2\"}\n::: {.cell-output-display}\n![](lec0x-confounding_files/figure-html/unnamed-chunk-2-1.png){width=576}\n:::\n\n::: {.cell-output-display}\n![](lec0x-confounding_files/figure-html/unnamed-chunk-2-2.png){width=576}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\nThere appears to be a tendency for taller men to have higher FEV1, but FEV1 also decreases with age.\n\n\\\n\nWe need to have a robust model that can incorporate information from multiple variables at the same time.\n\n\n:::\n\n::::\n\n\n\n## Framework\n\n-   Multiple linear regression (MLR) is our tool to expand our MODEL to better fit the DATA.\n-   Describes a *linear relationship* between a single continuous $Y$ variable, and several $X$ variables.\n-   Models $Y$ from $X_{1}, X_{2}, \\ldots , X_{P}$.\n-   X's can be continuous or discrete (categorical)\n-   X's can be transformations of other X's, e.g., $log(x), x^{2}$.\n\n## Visualization\n\nNow it's no longer a 2D regression *line*, but a $p$ dimensional regression plane.\n\n![A regression plane in 3 dimensions: $FEV1 \\sim Height + Age$](images/regression_plane.png){width=\"603\"}\n\n\n## Mathematical Model\n\nThe mathematical model for multiple linear regression equates the value of the continuous outcome $y_{i}$ to a **linear combination** of multiple predictors $x_{1} \\ldots x_{p}$ each with their own slope coefficient $\\beta_{1} \\ldots \\beta_{p}$. \n\n$$ y_{i} = \\beta_{0} + \\beta_{1}x_{1i} + \\ldots + \\beta_{p}x_{pi} + \\epsilon_{i}$$\n\nwhere $i$ indexes the observations $i = 1 \\ldots n$, and $j$ indexes the number of parameters $j=1 \\ldots p$.\n\n## Assumptions \n\nThe assumptions on the residuals $\\epsilon_{i}$ still hold:   \n\n* They have mean zero  \n* They are homoscedastic, that is all have the same finite variance: $Var(\\epsilon_{i})=\\sigma^{2}<\\infty$  \n* Distinct error terms are uncorrelated: (Independent) $\\text{Cov}(\\epsilon_{i},\\epsilon_{j})=0,\\forall i\\neq j.$  \n\n\n## Parameter Estimation {.smaller}\n\nFind the values of $b_j$ that minimize the difference between the value of the dependent variable predicted by the model $\\hat{y}_{i}$ and the true value of the dependent variable $y_{i}$.\n\n$$ \\hat{y_{i}} - y_{i} \\quad \\mbox{ where } \\quad \\hat{y}_{i}  = \\sum_{i=1}^{p}X_{ij}b_{j}$$\n\nAKA: Minimize the sum of the squared residuals: \n\n$$ \\sum_{i=1}^{n} (y_{i} - \\sum_{i=1}^{p}X_{ij}b_{j})^{2}$$\n\n\n## Fitting the model {.smaller}\n\nFitting a regression model in R with more than 1 predictor is done by adding each variable to the right hand side of the model notation connected with a `+`. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(FFEV1 ~ FAGE + FHEIGHT, data=fev)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = FFEV1 ~ FAGE + FHEIGHT, data = fev)\n\nCoefficients:\n(Intercept)         FAGE      FHEIGHT  \n   -2.76075     -0.02664      0.11440  \n```\n:::\n:::\n\n\n\n* Each $\\beta_{j}$ coefficient is considered a slope. The amount $Y$ will change for every 1 unit increase in $X_{j}$. \n* In a multiple variable regression model, $b_{j}$ is the estimated change in $Y$ _after controlling for other predictors in the model_. \n\n\n## Interpreting Coefficients  {.smaller}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmlr.dad.model <- lm(FFEV1 ~ FAGE + FHEIGHT, data=fev)\ntidy(mlr.dad.model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 Ã— 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)  -2.76     1.14        -2.43 1.65e- 2\n2 FAGE         -0.0266   0.00637     -4.18 4.93e- 5\n3 FHEIGHT       0.114    0.0158       7.25 2.25e-11\n```\n:::\n\n```{.r .cell-code}\nconfint(mlr.dad.model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  2.5 %      97.5 %\n(Intercept) -5.00919751 -0.51229620\nFAGE        -0.03922545 -0.01405323\nFHEIGHT      0.08319434  0.14559974\n```\n:::\n:::\n\n\n\n* Holding height constant, a father who is ten years older is expected to have a FEV value 0.27 (0.14, 0.39) liters less than another man (p<.0001).\n* Holding age constant, a father who is 1cm taller than another man is expected to have a FEV value of 0.11 (.08, 0.15) liter greater than the other man (p<.0001). \n\n\n\n# Confounding \n\n![All the ways covariates can affect response variables](images/confounder.png)\n\n## Confounding\n\nOther factors (characteristics/variables) could also be explaining part of the variability seen in $y$. \n\n> If the relationship between $x_{1}$ and $y$ is bivariately significant, but then no longer significant once $x_{2}$ has been added to the model, then $x_{2}$ is said to explain, or **confound**, the relationship between $x_{1}$ and $y$.\n\n## Identifying a confounder\n\n1. Fit a regression model on $y \\sim x_{1}$. \n2. If $x_{1}$ is not significantly associated with $y$, STOP. Re-read the \"IF\" part of the definition of a confounder. \n3. Fit a regression model on $y \\sim x_{1} + x_{2}$. \n4. Look at the p-value for $x_{1}$. One of two things will have happened. \n    - If $x_{1}$ is still significant, then $x_{2}$ does NOT confound (or explain) the relationship between $y$ and $x_{1}$. \n    - If $x_{1}$ is NO LONGER significantly associated with $y$, then $x_{2}$ IS a confounder. \n    \n\nThis means that the third variable is explaining the relationship between the explanatory variable and the response variable.\n        \n\n# Example: Does the early bird get the worm?\n\n\n## 1. Identify variables\n\n* Quantitative outcome: Income (variable `income`). \n* Quantitative predictor: Time you wake up in the morning (variable `wakeup`)\n* Binary confounder: Gender (variable `female_c`). This variable is 1 if female, 0 if male. \n \n\n## 2. State hypotheses\n\n* Null: There is no relationship between the time you wake up and your personal earnings \n    - $y \\sim \\beta_{0} + \\beta_{1}x_{1}, \\qquad H_{0}: \\beta_{1}=0$\n* Alternative: There is a relationship between the time you wake up and your personal earnings \n    - $y \\sim \\beta_{0} + \\beta_{1}x_{1}, \\qquad H_{0}: \\beta_{1} \\neq 0$ \n* Confounder:  There is still a relationship between the time you wake up and your personal earnings, after controlling for gender. \n  - $y \\sim \\beta_{0} + \\beta_{1}x_{1} + \\beta_{2}x_{2}, \\qquad H_{0}: \\beta_{1} \\neq 0$ \n\n## 3. Visualize and Assess\n\n:::: {.columns}\n\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\naddhealth %>% select(wakeup, income, female_c) %>% na.omit() %>%\n  ggplot(aes(x=wakeup, y = income, color = female_c)) + \n  geom_point() + geom_smooth() + theme_bw()\n```\n\n::: {.cell-output-display}\n![](lec0x-confounding_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"40%\"}\nFlat, somewhat linear trend, looks slightly different for males vs females, before 11am. \n:::\n\n::::\n\n\n## 4. Fit the simple model\nIs there a relationship between income and time a person wakes up? \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm.mod1 <- lm(income ~ wakeup, data=addhealth) \ntidy(lm.mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 Ã— 5\n  term        estimate std.error statistic   p.value\n  <chr>          <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)   43548.     1126.     38.7  3.03e-276\n2 wakeup         -488.      151.     -3.22 1.27e-  3\n```\n:::\n:::\n\n\n\nThe estimate of the regression coefficient for `wakeup` is significant (b1=-488, p= 0.001). There is reason to believe that the time you wakeup is associated with your income. \n\n\n## 5. Fit the multivariable model\n\nDetermine if the third variable is a confounder.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm.mod2 <- lm(income ~ wakeup + female_c, data=addhealth) \ntidy(lm.mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 Ã— 5\n  term           estimate std.error statistic   p.value\n  <chr>             <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)      48669.     1207.     40.3  2.06e-296\n2 wakeup            -611.      149.     -4.09 4.37e-  5\n3 female_cFemale   -8527.      789.    -10.8  8.09e- 27\n```\n:::\n:::\n\n\n\nThe relationship between income and wake up time is still significant after controlling for gender. Gender is **not** a confounder. \n\n## 6. Assess model fit\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_model(lm.mod2)\n```\n\n::: {.cell-output-display}\n![](lec0x-confounding_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n## 6. Assess model fit\n\nThis model doesn't fit the data incredibly well. \n\n* The residuals are somewhat not normal\n* predicted income higher than the observed. \n* There is indication of non-constant variance as well,\n* Quadratic trend to the standardized residuals when the fitted income is above 40k. \n\n## 7. Interpret the coefficients {.smaller}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl_regression(lm.mod2, intercept = TRUE) %>% \n   add_glance_table(include = c(adj.r.squared))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"knvsgivhmk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#knvsgivhmk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#knvsgivhmk thead, #knvsgivhmk tbody, #knvsgivhmk tfoot, #knvsgivhmk tr, #knvsgivhmk td, #knvsgivhmk th {\n  border-style: none;\n}\n\n#knvsgivhmk p {\n  margin: 0;\n  padding: 0;\n}\n\n#knvsgivhmk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#knvsgivhmk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#knvsgivhmk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#knvsgivhmk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#knvsgivhmk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#knvsgivhmk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#knvsgivhmk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#knvsgivhmk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#knvsgivhmk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#knvsgivhmk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#knvsgivhmk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#knvsgivhmk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#knvsgivhmk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#knvsgivhmk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#knvsgivhmk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#knvsgivhmk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#knvsgivhmk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#knvsgivhmk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#knvsgivhmk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#knvsgivhmk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#knvsgivhmk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#knvsgivhmk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#knvsgivhmk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#knvsgivhmk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#knvsgivhmk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#knvsgivhmk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#knvsgivhmk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#knvsgivhmk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#knvsgivhmk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#knvsgivhmk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#knvsgivhmk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#knvsgivhmk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#knvsgivhmk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#knvsgivhmk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#knvsgivhmk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#knvsgivhmk .gt_left {\n  text-align: left;\n}\n\n#knvsgivhmk .gt_center {\n  text-align: center;\n}\n\n#knvsgivhmk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#knvsgivhmk .gt_font_normal {\n  font-weight: normal;\n}\n\n#knvsgivhmk .gt_font_bold {\n  font-weight: bold;\n}\n\n#knvsgivhmk .gt_font_italic {\n  font-style: italic;\n}\n\n#knvsgivhmk .gt_super {\n  font-size: 65%;\n}\n\n#knvsgivhmk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#knvsgivhmk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#knvsgivhmk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#knvsgivhmk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#knvsgivhmk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#knvsgivhmk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#knvsgivhmk .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Beta&lt;/strong&gt;\"><strong>Beta</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>95% CI</strong><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;p-value&lt;/strong&gt;\"><strong>p-value</strong></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">48,669</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">46,303, 51,036</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">wakeup</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-611</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-904, -318</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">female_c</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Â Â Â Â Male</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">â€”</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">â€”</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Â Â Â Â Female</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-8,527</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-10,075, -6,980</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">Adjusted RÂ²</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\">0.032</td>\n<td headers=\"ci\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\" style=\"border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;\"><br /></td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> CI = Confidence Interval</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n* $b_{0}$: For a male (`gender=0`) who wakes up at midnight (`wakeup=0`), their predicted average income is \\$48,669.4 (95% CI \\$46,303.9, \\$51,035)\n* $b_{1}$: Holding gender constant, for every hour later a person wakes up, their predicted average income drops by \\$611 (95% CI \\$319, \\$904). \n* $b_{2}$: Controlling for the time someone wakes up in the morning, the predicted average income for females is \\$8,527 (95% CI \\$6,980, \\$10,074) lower than for males.\n:::\n\n::::\n\n\n## 8. Write a conclusion\n\nAfter adjusting for the potential confounding factor of gender, wake up time ($b_{1}$ = `-611, 95% CI: (-904, -318), p<.0001`) was significantly and negatively associated with income. Approximately `3.2%` of the variance of income can be accounted for by wake up time after controlling for gender. Based on these analyses, gender _is not_ a confounding factor because the association between wake up time and income _is still_ significant after accounting for gender.\n\n",
    "supporting": [
      "lec0x-confounding_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}