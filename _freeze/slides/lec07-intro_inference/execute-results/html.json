{
  "hash": "afc267432e1a1d62f0ee0b46ecc9a8d4",
  "result": {
    "markdown": "---\ntitle: \"Statistical Inference with Mathematical Models\"\ndate: \"2022-10-05\"\ndescription: \"7, 8\"\nauthor: \"Robin Donatello\"\nfooter: \"[ðŸ”— https://norcalbiostat.github.io/MATH615](https://norcalbiostat.github.io/MATH615/) / Statistical Inference with Mathematical Models\"\nfrom: markdown+emoji\nformat: \n  revealjs:\n    theme: beige\n    multiplex: true\n    transition: fade\n    slide-number: true\n    incremental: false \n    chalkboard: true\nexecute:\n  freeze: auto\n  echo: false\nknitr:\n  opts_chunk: \n    R.options:\n      width: 200\n---\n\n\n\n# Statistical Inference\n\n(A.K.A Hypothesis Testing)\n\n![https://xkcd.com/1478/](https://imgs.xkcd.com/comics/p_values.png)\n\n## Statistical Inference\n\n::: incremental\n-   Primarily concerned with understanding and quantifying the uncertainty of parameter estimates.\n-   Equations and details change depending on the setting, the foundations for inference are the same throughout all of statistics.\n-   We start with a case studies designed to motivate the process of making decisions about research claims.\n-   We formalize the process through the introduction of the hypothesis testing framework, which allows us to formally evaluate claims about the population.\n:::\n\n## Variability in data \n\n::: incremental\n* Sometimes the dataset at hand represents the entire research question.\n* More often than not, the data have been collected to answer a research question about a larger group of which the data are a (hopefully) representative subset.\n* One dataset will not be identical to a second dataset even if they are both collected from the same population using the same methods.\n:::\n\n## \n\n::: {.callout-warning icon=\"false\"}\n## Could it be chance?\n\nSuppose your professor splits the students in your class into two groups: students who sit on the left side of the classroom and students who sit on the right side of the classroom. \n\nIf $p_{L}$ represents the proportion of students who prefer to read books on screen who sit on the left side of the classroom and $p_{R}$ represents the proportion of students who prefer to read books on screen who sit on the right side of the classroom, would you be surprised if $p_{L}$ did not exactly equal $p_{R}$?\n:::\n\n. . . \n\n::: {.callout-info icon=\"false\"}\n## Assumptions\nIf we do not think the side of the room a person sits on in class is related to whether they prefer to read books on screen, what assumption are we making about the relationship between these two variables (side of room and preferring to read books)?\n:::\n\n## Randomization \n\nTo decide whether variability in data is due to (1) the causal mechanism (the randomized explanatory variable in the experiment) or (2) natural variability inherent to the data we set up a sham randomized experiment as a comparison. \n\n* We assume that each observational unit would have gotten the exact same response value regardless of the treatment level. \n* By reassigning the treatments many many times, we can compare the actual experiment to the sham experiment. \n\n## Decision\n\nIf the actual experiment has **more extreme results** than any of the sham experiments, we are led to believe that it is the explanatory variable which is causing the result and not just variability inherent to the data. \n\n\n## Case Study: Sex discrimination\n\nOpen the collaborative notes and work with your neighbor to answer the following questions. You will be randomly assigned to write out your answer in this document. \n\n[https://hackmd.io/\\@norcalbiostat/07-intro_inference](https://hackmd.io/@norcalbiostat/07-intro_inference)\n\n## \n\n\\\n\n::: {.callout-note icon=\"false\"}\n## Statistical inference is the practice of making decisions and conclusions from data in the context of uncertainty. \n\nErrors do occur, just like rare events, and the dataset at hand might lead us to the wrong conclusion. While a given dataset may not always lead us to a correct conclusion, statistical inference gives us tools to control and evaluate how often these errors occur. \n:::\n\n# Inference with Mathematical Models\n\n\n::: {.cell}\n\n:::\n\n\n![](images/paranormal.png)\n\n## Refresher on the Normal Distribution \n\n:::{layout-ncol=2}\nThe normal distribution is used to describe the variability associated with sample statistics which are taken from either repeated samples or repeated experiments. The normal distribution is quite powerful in that it describes the variability of many different statistics such as the sample mean and sample proportions. \n\n<a href=\"https://twitter.com/RiddleMeCam/status/1557402268395139077?ref_src=twsrc%5Etfw\">![](images/clt_twitter.png)</a>\n\n:::\n\n\n\n\n## Collaborative Notes\nReturn to the collaborative notes and answer your assigned questions. \n\n[https://hackmd.io/\\@norcalbiostat/07-intro_inference](https://hackmd.io/@norcalbiostat/07-intro_inference)\n\n# Case study: Stents\n\n## Observed data\n\nConsider an experiment that examined whether implanting a stent in the brain of a patient at risk for a stroke helps reduce the risk of a stroke. The results from the first 30 days of this study are summarized in the following table.\n\n::: columns\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n           \n            no event stroke Sum\n  control        214     13 227\n  treatment      191     33 224\n  Sum            405     46 451\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n           \n            no event stroke\n  control       0.94   0.06\n  treatment     0.85   0.15\n```\n:::\n:::\n\n:::\n:::\n\nThese results are surprising! The point estimate suggests that patients who received stents may have a higher risk of stroke: $p_{trmt}âˆ’p_{ctrl}=0.090$.\n\n## Point estimate vs Interval estimate\n\nThe point estimate for the difference in proportions $p_{trmt}âˆ’p_{ctrl}=0.090$ is a single point estimate, based on this single sample.\n\n\\\n\nA *point estimate* is our best guess for the value of the parameter, so it makes sense to build the confidence interval around that value.\n\n## Constructing a 95% confidence interval (CI)\n\nWhen the sampling distribution of a point estimate can _reasonably be modeled as having a normal distribution_, the point estimate we observe will be within 1.96 standard errors of the true value of interest about 95% of the time. Thus, a 95% confidence interval for such a point estimate can be constructed:\n\n\n$$\\mbox{point estimate} \\pm 1.96 Ã— SE$$\n\n\nWe can be 95% confident this interval captures the true value.\n\n## Construct a 95% CI for the stent example {.smaller}\n\nThe conditions necessary to ensure the point estimate $p_{trmt}âˆ’p_{ctrl}$ is nearly normal have been verified for you, and the estimate's standard error is $SE = 0.028$.\n\n-   Construct a 95% confidence interval for the change in 30-day stroke rates from usage of the stent.\n-   Interpret this interval in context of the problem.\n\n. . . \n\n\n$$0.090 \\pm 1.96Ã—0.028 = (0.035,0.145)$$\n\n\nWe are 95% confident that implanting a stent in a stroke patient's brain increased the risk of stroke within 30 days by a rate of 0.035 to 0.145.\n\n## Important note\n\n:warning: it's incorrect to say that we can be 95% confident that the true value is inside the mean.\n\n![Figure 13.11: Twenty-five samples of size n=300 were collected from a population with p=0.30. For each sample, a confidence interval was created to try to capture the true proportion p. However, 1 of these 25 intervals did not capture p=0.30.](https://openintro-ims.netlify.app/13-foundations-mathematical_files/figure-html/95PercentConfidenceInterval-1.png)\n\n## \n\n-   This is one of the most common errors: while it might be useful to think of it as a probability, the confidence level only quantifies how plausible it is that the parameter is in the interval.\n-   Our intervals say nothing about the confidence of capturing individual observations, a proportion of the observations, or about capturing point estimates.\n-   Confidence intervals provide an interval estimate for and attempt to capture population parameters.\n\n## Hypothesis test\n\n::: {.callout-note icon=\"false\"}\n## First draft \nLet's setup a hypothesis to test if stents work to reduce the risk of a stroke.  \n:::\n\n\\\n\n$H_{0}$: Stents don't work\n\n$H_{A}$: Stents reduce the risk of a stroke\n\n## Hypothesis test\n\n::: {.callout-note icon=\"false\"}\n## Revision 1: \nMaking it a statement about two groups \n:::\n\n\n$H_{0}$: Patients who have a stent have the same risk of a stroke as patients who don't have a stent\n\n$H_{A}$: Patients who have a stent have lower risk of a stroke as patients who don't have a stent\n\n## Hypothesis test\n\n::: {.callout-note icon=\"false\"}\n## Revision 2: \nMake it a statement using summary statistics and removing the directionality of the hypothesis\n:::\n\n\\ \n\n$H_{0}$: The proportion of patients with a stent who have a stroke is the same as the proportion of patients without a stent who have a stroke. \n\n$H_{A}$: The proportion of patients with a stent who have a stroke is different than the proportion of patients without a stent who have a stroke. \n\n## Hypothesis test\n\n::: {.callout-note icon=\"false\"}\n## Revision 3: \nWriting it in symbols\n:::\n\nLet $p_{trmt}$ be the proportion of patients with a stent who have a stroke, and $p_{ctrl}$ be the proportion of patients without a stent who have a stroke \n\n\\\n\n$H_{0}: p_{trmt} = p_{ctrl}$\n\n$H_{A}: p_{trmt} \\neq p_{ctrl}$\n\n## Hypothesis test\n\n::: {.callout-note icon=\"false\"}\n## Revision 3.5: \n\nRewriting as a difference in parameters\n:::\n\nLet $p_{1}$ be the proportion of patients with a stent who have a stroke, and $p_{ctrl}$ be the proportion of patients without a stent who have a stroke \n\n\\\n\n$H_{0}: p_{trmt} - p_{ctrl} = 0$\n\n$H_{A}: p_{trmt} - p_{ctrl} \\neq 0$\n\n## Calculating a test statistic\n\n\n$$ Z = \\frac{\\mbox{point estimate - null value}}{SE}$$\n\n. . . \n\n$$ Z = \\frac{(p_{trmt} - p_{ctrl}) - 0}{SE_{p_{trmt} - p_{ctrl}}} = \\frac{.090}{.028} = 3.21 $$\n\n. . . \n\n$$ P(Z > 3.2) = .00068 \\qquad \\mbox{ (the p-value)}$$ \n\n. . . \n\nIf the true difference in proportions was 0, then the probability of observing a difference of 0.09 due to random chance is 0.00068. \n\n## \n\n![https://xkcd.com/1478/](https://imgs.xkcd.com/comics/p_values.png)\n\n\n## Using Confidence Intervals to test a hypothesis\n\n> We are 95% confident that implanting a stent in a stroke patient's brain increased the risk of stroke within 30 days by a rate of 0.035 to 0.145.\n\nSince the interval does not contain the null hypothesized value of 0 (is completely above 0), it means the data provide convincing evidence that the stent used in the study changed the risk of stroke within 30 days\n",
    "supporting": [
      "lec07-intro_inference_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n\r\n      // dispatch for htmlwidgets\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for reveal\r\n    if (window.Reveal) {\r\n      window.Reveal.addEventListener(\"slidechanged\", function(event) {\r\n        fireSlideChanged(event.previousSlide, event.currentSlide);\r\n      });\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}